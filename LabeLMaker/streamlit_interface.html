<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://sites.uab.edu/periop-datascience/LabeLMaker/streamlit_interface.html" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Label Maker Handler - Label Maker</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Label Maker Handler";
        var mkdocs_page_input_path = "LabeLMaker/streamlit_interface.md";
        var mkdocs_page_url = "/periop-datascience/LabeLMaker/streamlit_interface.html";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Label Maker
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Workflows</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="workflow.html">Main</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Generative Categorizer</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Label Maker Handler</a>
    <ul class="current">
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Categorize</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="Categorize/categorizer.html">Categorizer</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="Categorize/zeroshot.html">Zeroshot</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="Categorize/fewshot.html">Fewshot</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="Categorize/manyshot.html">Manyshot</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Evaluate</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="Evaluate/evaluator.html">Evaluator</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="Evaluate/confidence_intervals.html">Confidence Intervals</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="Evaluate/data_loader.html">Data Loader</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Utils</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="utils/category.html">Category</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="utils/class_balance.html">Class Balance</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="utils/file_manager.html">File Manager</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="utils/normalize_text.html">Normalize Text</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="utils/page_renderer.html">Page Renderer</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LabeLMaker_config</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../LabeLMaker_Config/config.md">Config</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Label Maker</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Generative Categorizer</li>
      <li class="breadcrumb-item active">Label Maker Handler</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/uabperiopai/edit/master/docs/LabeLMaker/streamlit_interface.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <div class="doc doc-object doc-module">



<a id="LabeLMaker.streamlit_interface"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="LabeLMaker.streamlit_interface.BaseHandler" class="doc doc-heading">
            <code>BaseHandler</code>


</h2>


    <div class="doc doc-contents ">


        <p>Provides common helper functionality used in evaluation and categorization tasks,
such as file upload and download functions.</p>







              <details class="quote">
                <summary>Source code in <code>LabeLMaker/streamlit_interface.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BaseHandler</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Provides common helper functionality used in evaluation and categorization tasks,</span>
<span class="sd">    such as file upload and download functions.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ui_helper</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The function initializes an object with a UI helper wrapper provided as a parameter.</span>

<span class="sd">        Args:</span>
<span class="sd">          ui_helper: The `ui_helper` parameter in the `__init__` method is expected to be an object that</span>
<span class="sd">        represents a UI helper wrapper, such as a Streamlit UI object. This parameter is used to interact</span>
<span class="sd">        with the user interface within the class or object where the `__init__` method is defined</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span> <span class="o">=</span> <span class="n">ui_helper</span>  <span class="c1"># The UI helper wrapper (e.g., Streamlit UI)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_ensure_file</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">file</span><span class="p">,</span>
        <span class="n">upload_message</span><span class="p">,</span>
        <span class="n">file_types</span><span class="p">,</span>
        <span class="n">key</span><span class="p">,</span>
        <span class="n">info_message</span><span class="p">,</span>
        <span class="n">accept_multiple_files</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The function `_ensure_file` checks if a file is provided, and if not, prompts the user to upload</span>
<span class="sd">        a file or displays an info message.</span>

<span class="sd">        Args:</span>
<span class="sd">          file: The `file` parameter in the `_ensure_file` method is used to represent the file that</span>
<span class="sd">        needs to be ensured or uploaded. If the `file` is `None`, the method will call the UI uploader</span>
<span class="sd">        to upload a file.</span>
<span class="sd">          upload_message: `upload_message` is a message that will be displayed to prompt the user to</span>
<span class="sd">        upload a file. It serves as an instruction or guidance for the user on what action to take.</span>
<span class="sd">          file_types: The `file_types` parameter in the `_ensure_file` method is used to specify the</span>
<span class="sd">        types of files that can be uploaded. It is typically a list of strings representing the allowed</span>
<span class="sd">        file extensions or MIME types. For example, `file_types=[&#39;.txt&#39;, &#39;.csv&#39;, &#39;image/jpeg&#39;]`</span>
<span class="sd">          key: The `key` parameter in the `_ensure_file` method is used as a unique identifier for the</span>
<span class="sd">        file uploader component. It helps in associating the uploaded file with a specific key, which</span>
<span class="sd">        can be useful for tracking or handling the file data within the application.</span>
<span class="sd">          info_message: The `info_message` parameter in the `_ensure_file` method is a message that will</span>
<span class="sd">        be displayed if the `file` is still `None` after attempting to upload a file using the UI</span>
<span class="sd">        uploader. It serves as an informational message to the user indicating that no file was</span>
<span class="sd">        uploaded.</span>
<span class="sd">          accept_multiple_files (bool): The `accept_multiple_files` parameter in the `_ensure_file`</span>
<span class="sd">        method is a boolean flag that determines whether the file uploader should allow the user to</span>
<span class="sd">        upload multiple files at once. If set to `True`, the file uploader will enable the user to</span>
<span class="sd">        select and upload multiple files simultaneously. If set to `. Defaults to False</span>

<span class="sd">        Returns:</span>
<span class="sd">          the `file` variable, which may have been updated based on the conditions inside the function.</span>
<span class="sd">        If `file` is None initially and remains None after attempting to upload a file, an info message</span>
<span class="sd">        is displayed and None is returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">file_uploader</span><span class="p">(</span>
                <span class="n">label</span><span class="o">=</span><span class="n">upload_message</span><span class="p">,</span>
                <span class="nb">type</span><span class="o">=</span><span class="n">file_types</span><span class="p">,</span>
                <span class="n">accept_multiple_files</span><span class="o">=</span><span class="n">accept_multiple_files</span><span class="p">,</span>
                <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">info_message</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">file</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_docx_report_download</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The function generates a DOCX report and converts it into bytes for file download.</span>

<span class="sd">        Args:</span>
<span class="sd">          doc: The `doc` parameter in the `generate_docx_report_download` function is expected to be a</span>
<span class="sd">        DOCX Document object that you want to convert into bytes for file download.</span>

<span class="sd">        Returns:</span>
<span class="sd">          The function `generate_docx_report_download` returns the DOCX document converted into bytes to</span>
<span class="sd">        allow file download.</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the DOCX Document into bytes to allow file download.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">temp_stream</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">temp_stream</span><span class="p">)</span>
        <span class="n">temp_stream</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">temp_stream</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="LabeLMaker.streamlit_interface.BaseHandler.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">ui_helper</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The function initializes an object with a UI helper wrapper provided as a parameter.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>ui_helper</code></b>
              –
              <div class="doc-md-description">
                <p>The <code>ui_helper</code> parameter in the <code>__init__</code> method is expected to be an object that</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>represents a UI helper wrapper, such as a Streamlit UI object. This parameter is used to interact
with the user interface within the class or object where the <code>__init__</code> method is defined</p>


            <details class="quote">
              <summary>Source code in <code>LabeLMaker/streamlit_interface.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ui_helper</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The function initializes an object with a UI helper wrapper provided as a parameter.</span>

<span class="sd">    Args:</span>
<span class="sd">      ui_helper: The `ui_helper` parameter in the `__init__` method is expected to be an object that</span>
<span class="sd">    represents a UI helper wrapper, such as a Streamlit UI object. This parameter is used to interact</span>
<span class="sd">    with the user interface within the class or object where the `__init__` method is defined</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span> <span class="o">=</span> <span class="n">ui_helper</span>  <span class="c1"># The UI helper wrapper (e.g., Streamlit UI)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="LabeLMaker.streamlit_interface.BaseHandler.generate_docx_report_download" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_docx_report_download</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The function generates a DOCX report and converts it into bytes for file download.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>doc</code></b>
              –
              <div class="doc-md-description">
                <p>The <code>doc</code> parameter in the <code>generate_docx_report_download</code> function is expected to be a</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>DOCX Document object that you want to convert into bytes for file download.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>The function <code>generate_docx_report_download</code> returns the DOCX document converted into bytes to</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>allow file download.</p>


            <details class="quote">
              <summary>Source code in <code>LabeLMaker/streamlit_interface.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_docx_report_download</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The function generates a DOCX report and converts it into bytes for file download.</span>

<span class="sd">    Args:</span>
<span class="sd">      doc: The `doc` parameter in the `generate_docx_report_download` function is expected to be a</span>
<span class="sd">    DOCX Document object that you want to convert into bytes for file download.</span>

<span class="sd">    Returns:</span>
<span class="sd">      The function `generate_docx_report_download` returns the DOCX document converted into bytes to</span>
<span class="sd">    allow file download.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert the DOCX Document into bytes to allow file download.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">temp_stream</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
    <span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">temp_stream</span><span class="p">)</span>
    <span class="n">temp_stream</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">temp_stream</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="LabeLMaker.streamlit_interface.CategorizeHandler" class="doc doc-heading">
            <code>CategorizeHandler</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseHandler (LabeLMaker.streamlit_interface.BaseHandler)" href="#LabeLMaker.streamlit_interface.BaseHandler">BaseHandler</a></code></p>


        <p>Handles file uploads and categorization workflows.
Includes both single and multiple file upload, workflow setup and execution,
and processing of categorization results using zero-shot, few-shot, or many-shot methods.</p>







              <details class="quote">
                <summary>Source code in <code>LabeLMaker/streamlit_interface.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CategorizeHandler</span><span class="p">(</span><span class="n">BaseHandler</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles file uploads and categorization workflows.</span>
<span class="sd">    Includes both single and multiple file upload, workflow setup and execution,</span>
<span class="sd">    and processing of categorization results using zero-shot, few-shot, or many-shot methods.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ui_helper</span><span class="p">,</span> <span class="n">azure_key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The function initializes a class instance with a UI helper and an optional Azure key for file</span>
<span class="sd">        management and configuration.</span>

<span class="sd">        Args:</span>
<span class="sd">          ui_helper: The `ui_helper` parameter is an object that provides helper</span>
<span class="sd">        functions or utilities related to user interface operations. It is being passed to the constructor</span>
<span class="sd">        of the current class as an argument.</span>
<span class="sd">          azure_key: The `azure_key` parameter is an optional parameter that can be passed to the `__init__`</span>
<span class="sd">        method of a class. It is used to provide an Azure key that may be required for certain operations</span>
<span class="sd">        within the class. If a value is provided for `azure_key`, it will be used to</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ui_helper</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fm</span> <span class="o">=</span> <span class="n">FileManager</span><span class="p">(</span><span class="n">azure_key</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">Config</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_document_analysis_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function returns a valid document analysis client based on the configuration provided.</span>

<span class="sd">        Returns:</span>
<span class="sd">          A valid document analysis client based on the configuration is being returned if the condition `if</span>
<span class="sd">        hasattr(self.config, &quot;AZURE_DOCAI_KEY&quot;) and self.config.AZURE_DOCAI_KEY` is met. Otherwise, `None`</span>
<span class="sd">        is returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span> <span class="s2">&quot;AZURE_DOCAI_KEY&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">AZURE_DOCAI_KEY</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">create_document_analysis_client</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">AZURE_DOCAI_KEY</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_default_categories</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The function `_get_default_categories` retrieves unique values from a specified column in a</span>
<span class="sd">        DataFrame, with a warning if there are more than 10 unique values.</span>

<span class="sd">        Args:</span>
<span class="sd">          df: The `df` parameter in the `_get_default_categories` method is typically a pandas DataFrame</span>
<span class="sd">        that contains the data from which you want to extract unique values for a specific column (`col`).</span>
<span class="sd">        The method checks if the specified column exists in the DataFrame and then retrieves the unique</span>
<span class="sd">        values from that column to generate a</span>
<span class="sd">          col: The `col` parameter in the `_get_default_categories` method is used to specify the column</span>
<span class="sd">        name from the DataFrame (`df`) for which you want to retrieve default categories. The method checks</span>
<span class="sd">        if the column name is valid (not empty and exists in the DataFrame), then it retrieves unique</span>
<span class="sd">        non-null values</span>

<span class="sd">        Returns:</span>
<span class="sd">          An empty string is being returned if the conditions in the function are not met.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">col</span> <span class="ow">and</span> <span class="n">col</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">unique_values</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">MAX_RECOMMENDED_GROUPS</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;There are more than 10 unique values in the column. &quot;</span>
                    <span class="s2">&quot;Auto-population of categories may not be practical.&quot;</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="s2">&quot;&quot;</span>
            <span class="k">return</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">unique_values</span><span class="p">])</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_ground_truth_examples</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">id_col</span><span class="p">,</span> <span class="n">text_col</span><span class="p">,</span> <span class="n">gt_col</span><span class="p">,</span> <span class="n">few_shot_count</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">many_shot_train_ratio</span><span class="o">=</span><span class="mf">0.8</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The function `_prepare_ground_truth_examples` prepares few-shot and many-shot examples with</span>
<span class="sd">        corresponding IDs from a DataFrame based on specified parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">          df: DataFrame containing the data</span>
<span class="sd">          id_col: The `id_col` parameter in the `_prepare_ground_truth_examples` function refers to the</span>
<span class="sd">        column in the DataFrame `df` that contains unique identifiers for each record. This column is used</span>
<span class="sd">        to identify and track individual records within the dataset.</span>
<span class="sd">          text_col: The `text_col` parameter in the `_prepare_ground_truth_examples` method refers to the</span>
<span class="sd">        column in the DataFrame `df` that contains the text data for each example. This column will be used</span>
<span class="sd">        to extract the text information for creating examples during the preparation of ground truth</span>
<span class="sd">        examples.</span>
<span class="sd">          gt_col: The `gt_col` parameter in the `_prepare_ground_truth_examples` method refers to the column</span>
<span class="sd">        in the DataFrame `df` that contains the ground truth labels for the examples. This column is used</span>
<span class="sd">        for grouping the examples based on their ground truth labels during the preparation process.</span>
<span class="sd">          few_shot_count: The `few_shot_count` parameter in the `_prepare_ground_truth_examples` function</span>
<span class="sd">        determines the number of examples that will be included in the few-shot learning set. It specifies</span>
<span class="sd">        how many randomly sampled examples will be selected for each unique label in the dataset to create a</span>
<span class="sd">        few-shot learning subset. Defaults to 2</span>
<span class="sd">          many_shot_train_ratio: The `many_shot_train_ratio` parameter in the</span>
<span class="sd">        `_prepare_ground_truth_examples` function determines the ratio of examples that will be used for</span>
<span class="sd">        training in the &quot;many-shot&quot; category. For example, if `many_shot_train_ratio=0.8`, it means that 80%</span>
<span class="sd">        of the examples for</span>

<span class="sd">        Returns:</span>
<span class="sd">          The function `_prepare_ground_truth_examples` returns four values: `few_shot_examples`,</span>
<span class="sd">        `few_shot_ids`, `many_shot_examples`, and `many_shot_test_ids`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">few_shot_examples</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">few_shot_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">many_shot_examples</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">many_shot_test_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">df_gt</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">id_col</span><span class="p">,</span> <span class="n">text_col</span><span class="p">,</span> <span class="n">gt_col</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">df_gt</span><span class="p">[</span><span class="n">gt_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_gt</span><span class="p">[</span><span class="n">gt_col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">grouped</span> <span class="o">=</span> <span class="n">df_gt</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">gt_col</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
            <span class="n">records</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">)</span>
            <span class="n">count</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">few_shot_count</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">sampled</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">records</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">sampled</span><span class="p">:</span>
                    <span class="n">few_shot_examples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">Example</span><span class="p">(</span><span class="n">text_with_label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">text_col</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">gt_col</span><span class="p">]))</span>
                    <span class="p">)</span>
                    <span class="n">few_shot_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">id_col</span><span class="p">]))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">shuffled</span> <span class="o">=</span> <span class="n">records</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">shuffled</span><span class="p">)</span>
                <span class="n">train_size</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">many_shot_train_ratio</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)))</span>
                <span class="n">train_examples</span> <span class="o">=</span> <span class="n">shuffled</span><span class="p">[:</span><span class="n">train_size</span><span class="p">]</span>
                <span class="n">test_examples</span> <span class="o">=</span> <span class="n">shuffled</span><span class="p">[</span><span class="n">train_size</span><span class="p">:]</span>
                <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">train_examples</span><span class="p">:</span>
                    <span class="n">many_shot_examples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">Example</span><span class="p">(</span><span class="n">text_with_label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">text_col</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">gt_col</span><span class="p">]))</span>
                    <span class="p">)</span>
                <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">test_examples</span><span class="p">:</span>
                    <span class="n">many_shot_test_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">id_col</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">few_shot_examples</span><span class="p">,</span> <span class="n">few_shot_ids</span><span class="p">,</span> <span class="n">many_shot_examples</span><span class="p">,</span> <span class="n">many_shot_test_ids</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setup_workflow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The `setup_workflow` function in Python sets up parameters for a workflow, including selecting</span>
<span class="sd">        columns, creating unique identifiers, and choosing evaluation approaches.</span>

<span class="sd">        Args:</span>
<span class="sd">          df: The `setup_workflow` function is designed to set up parameters for a workflow based on user</span>
<span class="sd">        interactions with a UI. The function takes a DataFrame `df` as input and performs the following</span>
<span class="sd">        tasks:</span>

<span class="sd">        Returns:</span>
<span class="sd">          The `setup_workflow` function returns a dictionary `params` containing various parameters set</span>
<span class="sd">        based on user inputs and selections made during the workflow setup process. The function collects</span>
<span class="sd">        information such as the mode (Evaluation or Production), unique identifier column, categorizing</span>
<span class="sd">        column, ground truth column, evaluation techniques selected, and related parameters for Few Shot and</span>
<span class="sd">        Many Shot evaluation approaches. Additionally, it includes information about default categories and</span>
<span class="sd">        descriptions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">advanced_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">checkbox</span><span class="p">(</span>
            <span class="s2">&quot;Advanced Mode&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;For users with ground truth labels. Check to run evaluation pipeline.&quot;</span><span class="p">,</span>
            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;advanced_mode&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">advanced_mode</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;Advanced Mode is activated: Users can select classification mode (e.g., zero shot, few shot, or many shot)&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;Advanced Mode is not activated: Classification will be determined by number of examples provided&quot;</span>
            <span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Evaluation&quot;</span> <span class="k">if</span> <span class="n">advanced_mode</span> <span class="k">else</span> <span class="s2">&quot;Production&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;uniqueIdSetup_done&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;### Unique Identifier Setup&quot;</span><span class="p">)</span>
            <span class="n">id_choice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">radio</span><span class="p">(</span>
                <span class="s2">&quot;How would you like to specify a unique identifier?&quot;</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Create new ID column&quot;</span><span class="p">,</span> <span class="s2">&quot;Use an existing column&quot;</span><span class="p">],</span>
                <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id_choice&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">id_choice</span> <span class="o">==</span> <span class="s2">&quot;Create new ID column&quot;</span><span class="p">:</span>
                <span class="n">new_id_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">text_input</span><span class="p">(</span>
                    <span class="s2">&quot;Enter name for the new ID column&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;new_id_column&quot;</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;Create ID Column&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;create_id_column&quot;</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">new_id_col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                        <span class="n">df</span><span class="p">[</span><span class="n">new_id_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New ID column &#39;</span><span class="si">{</span><span class="n">new_id_col</span><span class="si">}</span><span class="s2">&#39; created.&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">new_id_col</span><span class="si">}</span><span class="s2">&#39; already exists; using it.&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;single_file_df&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;selected_id_column&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_id_col</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;uniqueIdSetup_done&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">selected_existing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span>
                    <span class="s2">&quot;Select the column to use as the unique identifier&quot;</span><span class="p">,</span>
                    <span class="n">options</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">key</span><span class="o">=</span><span class="s2">&quot;existing_id_column&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;Confirm ID Column&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;confirm_id_column&quot;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;selected_id_column&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_existing</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;uniqueIdSetup_done&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">sel_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;selected_id_column&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sel_id</span> <span class="ow">and</span> <span class="n">sel_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="n">sel_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;single_file_df&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;index_column&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;selected_id_column&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using &#39;</span><span class="si">{</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;index_column&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; as the unique identifier column.&quot;</span><span class="p">)</span>

        <span class="n">df_columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;categorizing_column&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span>
            <span class="s2">&quot;Select the column with text data you want to label&quot;</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="n">df_columns</span><span class="p">,</span>
            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;categorizing_column&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;ground_truth_column&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;ground_truth_column&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">gt_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span>
            <span class="s2">&quot;Select the column with ground truth labels&quot;</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="n">df_columns</span><span class="p">,</span>
            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;ground_truth_column&quot;</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="n">df_columns</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;ground_truth_column&quot;</span><span class="p">]),</span>
        <span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ground_truth_column&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gt_col</span>

        <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Evaluation&quot;</span><span class="p">:</span>
            <span class="n">eval_techniques</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">multiselect</span><span class="p">(</span>
                <span class="s2">&quot;Select the evaluation approaches to run:&quot;</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Zero Shot&quot;</span><span class="p">,</span> <span class="s2">&quot;Few Shot&quot;</span><span class="p">,</span> <span class="s2">&quot;Many Shot&quot;</span><span class="p">],</span>
                <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Zero Shot&quot;</span><span class="p">],</span>
                <span class="n">key</span><span class="o">=</span><span class="s2">&quot;evaluation_techniques&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;evaluation_techniques&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eval_techniques</span>
            <span class="k">if</span> <span class="s2">&quot;Few Shot&quot;</span> <span class="ow">in</span> <span class="n">eval_techniques</span><span class="p">:</span>
                <span class="n">few_shot_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">number_input</span><span class="p">(</span>
                    <span class="s2">&quot;Enter maximum examples per category (Few Shot)&quot;</span><span class="p">,</span>
                    <span class="n">min_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">key</span><span class="o">=</span><span class="s2">&quot;few_shot_count&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;few_shot_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">few_shot_count</span>
            <span class="k">if</span> <span class="s2">&quot;Many Shot&quot;</span> <span class="ow">in</span> <span class="n">eval_techniques</span><span class="p">:</span>
                <span class="n">many_shot_train_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">number_input</span><span class="p">(</span>
                    <span class="s2">&quot;Enter train proportion for Many Shot (0 to 1)&quot;</span><span class="p">,</span>
                    <span class="n">min_value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                    <span class="n">max_value</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                    <span class="n">value</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                    <span class="n">key</span><span class="o">=</span><span class="s2">&quot;many_shot_train_ratio&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;many_shot_train_ratio&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">many_shot_train_ratio</span>

        <span class="n">default_categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_default_categories</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">gt_col</span><span class="p">)</span>
        <span class="n">categories_dict</span><span class="p">,</span> <span class="n">categories_with_descriptions</span> <span class="o">=</span> <span class="n">CategoryManager</span><span class="o">.</span><span class="n">define_categories</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="p">,</span> <span class="s2">&quot;tab1&quot;</span><span class="p">,</span> <span class="n">unique_values_str</span><span class="o">=</span><span class="n">default_categories</span>
        <span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;categories_dict&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">categories_dict</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;categories_with_descriptions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">categories_with_descriptions</span>
        <span class="k">return</span> <span class="n">params</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">categorize_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">zs_prompty</span><span class="p">,</span> <span class="n">fs_prompty</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The function categorizes data based on specified parameters, using different techniques such as</span>
<span class="sd">        Zero Shot, Few Shot, and Many Shot categorization.</span>

<span class="sd">        Args:</span>
<span class="sd">          df: The `df` parameter in the `categorize_data` function is typically a pandas DataFrame</span>
<span class="sd">        containing the data that needs to be categorized. This DataFrame should include columns with the</span>
<span class="sd">        data to be categorized, as well as any additional columns required for the categorization</span>
<span class="sd">        process such as unique identifiers, ground truth labels</span>
<span class="sd">          params: The `params` dictionary contains the following keys and their corresponding values:</span>
<span class="sd">          zs_prompty: The `zs_prompty` parameter in the code snippet refers to the path of the Zero Shot</span>
<span class="sd">        categorization model that will be used in the workflow. This model is utilized for performing</span>
<span class="sd">        Zero Shot categorization, where the model predicts categories for data points without any prior</span>
<span class="sd">        training on those specific categories.</span>
<span class="sd">          fs_prompty: The `fs_prompty` parameter in the provided code snippet is used as the path to the</span>
<span class="sd">        Few-Shot Categorizer model for categorizing data. This path is utilized when running the</span>
<span class="sd">        workflow for Few Shot categorization within the `categorize_data` method. The Few-Shot Categor</span>

<span class="sd">        Returns:</span>
<span class="sd">          The `categorize_data` function returns a DataFrame `merged_df` that contains the original data</span>
<span class="sd">        along with additional columns for predicted category and rationale based on the categorization</span>
<span class="sd">        process specified in the function. The specific columns added to `merged_df` depend on the</span>
<span class="sd">        categorization mode chosen (Evaluation or Production) and the evaluation techniques used (Zero</span>
<span class="sd">        Shot, Few Shot, Many Shot).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">index_column</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;index_column&quot;</span><span class="p">]</span>
        <span class="n">cat_col</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;categorizing_column&quot;</span><span class="p">]</span>
        <span class="n">mode_choice</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">index_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unique ID column &#39;</span><span class="si">{</span><span class="n">index_column</span><span class="si">}</span><span class="s2">&#39; was not found. Creating new column &#39;</span><span class="si">{</span><span class="n">index_column</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
            <span class="p">)</span>
            <span class="n">df</span><span class="p">[</span><span class="n">index_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;selected_id_column&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">index_column</span>

        <span class="n">categories_dict</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;categories_dict&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">text_to_label</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">cat_col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">unique_ids</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">index_column</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">mode_choice</span> <span class="o">==</span> <span class="s2">&quot;Evaluation&quot;</span><span class="p">:</span>
            <span class="n">categorization_request</span> <span class="o">=</span> <span class="n">CategoryManager</span><span class="o">.</span><span class="n">create_request</span><span class="p">(</span>
                <span class="n">unique_ids</span><span class="p">,</span> <span class="n">text_to_label</span><span class="p">,</span> <span class="n">categories_dict</span>
            <span class="p">)</span>
            <span class="n">gt_column</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ground_truth_column&quot;</span><span class="p">]</span>
            <span class="n">eval_techniques</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;evaluation_techniques&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Zero Shot&quot;</span><span class="p">])</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">few_shot_count</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;few_shot_count&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">many_shot_train_ratio</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;many_shot_train_ratio&quot;</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
            <span class="p">(</span>
                <span class="n">few_shot_examples</span><span class="p">,</span>
                <span class="n">few_shot_ids</span><span class="p">,</span>
                <span class="n">many_shot_examples</span><span class="p">,</span>
                <span class="n">many_shot_test_ids</span><span class="p">,</span>
            <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_ground_truth_examples</span><span class="p">(</span>
                <span class="n">df</span><span class="p">,</span> <span class="n">index_column</span><span class="p">,</span> <span class="n">cat_col</span><span class="p">,</span> <span class="n">gt_column</span><span class="p">,</span> <span class="n">few_shot_count</span><span class="p">,</span> <span class="n">many_shot_train_ratio</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">technique</span> <span class="ow">in</span> <span class="n">eval_techniques</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">technique</span> <span class="o">==</span> <span class="s2">&quot;Zero Shot&quot;</span><span class="p">:</span>
                    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="s2">&quot;Running workflow (Zero Shot categorization)...&quot;</span><span class="p">):</span>
                        <span class="n">categorizer</span> <span class="o">=</span> <span class="n">ZeroShotCategorizer</span><span class="p">(</span>
                            <span class="n">prompty_path</span><span class="o">=</span><span class="n">zs_prompty</span><span class="p">,</span> <span class="n">category_request</span><span class="o">=</span><span class="n">categorization_request</span>
                        <span class="p">)</span>
                        <span class="n">results</span> <span class="o">=</span> <span class="n">categorizer</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
                    <span class="n">predictions</span><span class="p">[</span><span class="s2">&quot;Zero Shot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span>
                <span class="k">elif</span> <span class="n">technique</span> <span class="o">==</span> <span class="s2">&quot;Few Shot&quot;</span><span class="p">:</span>
                    <span class="n">few_shot_request</span> <span class="o">=</span> <span class="n">CategoryManager</span><span class="o">.</span><span class="n">create_request</span><span class="p">(</span>
                        <span class="n">unique_ids</span><span class="p">,</span> <span class="n">text_to_label</span><span class="p">,</span> <span class="n">categories_dict</span><span class="p">,</span> <span class="n">few_shot_examples</span>
                    <span class="p">)</span>
                    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="s2">&quot;Running workflow (Few Shot categorization)...&quot;</span><span class="p">):</span>
                        <span class="n">categorizer</span> <span class="o">=</span> <span class="n">FewShotCategorizer</span><span class="p">(</span>
                            <span class="n">prompty_path</span><span class="o">=</span><span class="n">fs_prompty</span><span class="p">,</span> <span class="n">category_request</span><span class="o">=</span><span class="n">few_shot_request</span>
                        <span class="p">)</span>
                        <span class="n">results</span> <span class="o">=</span> <span class="n">categorizer</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
                    <span class="n">filtered_results</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">few_shot_ids</span><span class="p">]</span>
                    <span class="n">predictions</span><span class="p">[</span><span class="s2">&quot;Few Shot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtered_results</span>
                <span class="k">elif</span> <span class="n">technique</span> <span class="o">==</span> <span class="s2">&quot;Many Shot&quot;</span><span class="p">:</span>
                    <span class="n">many_shot_request</span> <span class="o">=</span> <span class="n">CategoryManager</span><span class="o">.</span><span class="n">create_request</span><span class="p">(</span>
                        <span class="n">unique_ids</span><span class="p">,</span> <span class="n">text_to_label</span><span class="p">,</span> <span class="n">categories_dict</span><span class="p">,</span> <span class="n">many_shot_examples</span>
                    <span class="p">)</span>
                    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="s2">&quot;Running workflow (Many Shot categorization)...&quot;</span><span class="p">):</span>
                        <span class="n">categorizer</span> <span class="o">=</span> <span class="n">ManyshotClassifier</span><span class="p">(</span>
                            <span class="n">categorization_request</span><span class="o">=</span><span class="n">many_shot_request</span><span class="p">,</span>
                            <span class="n">min_class_count</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">MIN_SAMPLES_MANY_SHOT</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="n">results</span> <span class="o">=</span> <span class="n">categorizer</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
                    <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">in</span> <span class="n">many_shot_test_ids</span><span class="p">]</span>
                    <span class="n">predictions</span><span class="p">[</span><span class="s2">&quot;Many Shot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span>

            <span class="n">merged_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">tech</span><span class="p">,</span> <span class="n">results</span> <span class="ow">in</span> <span class="n">predictions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">tech_pred_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                    <span class="p">[(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">],</span>
                    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">index_column</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Predicted Category (</span><span class="si">{</span><span class="n">tech</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Rationale (</span><span class="si">{</span><span class="n">tech</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">],</span>
                <span class="p">)</span>
                <span class="n">merged_df</span><span class="p">[</span><span class="n">index_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="n">index_column</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
                <span class="n">tech_pred_df</span><span class="p">[</span><span class="n">index_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">tech_pred_df</span><span class="p">[</span><span class="n">index_column</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
                <span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">merged_df</span><span class="p">,</span> <span class="n">tech_pred_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">index_column</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">merged_df</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gt_column</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ground_truth_column&quot;</span><span class="p">]</span>
            <span class="n">all_examples</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">text</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">gt</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">text</span><span class="p">,</span> <span class="n">gt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">cat_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">gt_column</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">gt</span>
            <span class="p">]</span>
            <span class="n">categorization_request</span> <span class="o">=</span> <span class="n">CategoryManager</span><span class="o">.</span><span class="n">create_request</span><span class="p">(</span>
                <span class="n">unique_ids</span><span class="p">,</span> <span class="n">text_to_label</span><span class="p">,</span> <span class="n">categories_dict</span><span class="p">,</span> <span class="n">all_examples</span>
            <span class="p">)</span>
            <span class="n">num_examples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_examples</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of examples provided: </span><span class="si">{</span><span class="n">num_examples</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">categorized_results</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">num_examples</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="s2">&quot;Running workflow (Zero-Shot Production)...&quot;</span><span class="p">):</span>
                    <span class="n">categorizer</span> <span class="o">=</span> <span class="n">ZeroShotCategorizer</span><span class="p">(</span>
                        <span class="n">prompty_path</span><span class="o">=</span><span class="n">zs_prompty</span><span class="p">,</span> <span class="n">category_request</span><span class="o">=</span><span class="n">categorization_request</span>
                    <span class="p">)</span>
                    <span class="n">categorized_results</span> <span class="o">=</span> <span class="n">categorizer</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">num_examples</span> <span class="o">&lt;</span> <span class="n">Config</span><span class="o">.</span><span class="n">MIN_SAMPLES_MANY_SHOT</span><span class="p">:</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="s2">&quot;Running workflow (Few-Shot Production)...&quot;</span><span class="p">):</span>
                    <span class="n">categorizer</span> <span class="o">=</span> <span class="n">FewShotCategorizer</span><span class="p">(</span>
                        <span class="n">prompty_path</span><span class="o">=</span><span class="n">fs_prompty</span><span class="p">,</span> <span class="n">category_request</span><span class="o">=</span><span class="n">categorization_request</span>
                    <span class="p">)</span>
                    <span class="n">categorized_results</span> <span class="o">=</span> <span class="n">categorizer</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">label_counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">gt_column</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
                <span class="n">min_class_samples</span> <span class="o">=</span> <span class="n">label_counts</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">label_counts</span><span class="o">.</span><span class="n">empty</span> <span class="k">else</span> <span class="mi">0</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="s2">&quot;Running workflow (Many-Shot Production)...&quot;</span><span class="p">):</span>
                    <span class="n">categorizer</span> <span class="o">=</span> <span class="n">ManyshotClassifier</span><span class="p">(</span>
                        <span class="n">categorization_request</span><span class="o">=</span><span class="n">categorization_request</span><span class="p">,</span>
                        <span class="n">min_class_count</span><span class="o">=</span><span class="n">min_class_samples</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">categorized_results</span> <span class="o">=</span> <span class="n">categorizer</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
            <span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="p">[(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">categorized_results</span><span class="p">],</span>
                <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">index_column</span><span class="p">,</span> <span class="s2">&quot;Category&quot;</span><span class="p">,</span> <span class="s2">&quot;Rationale&quot;</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="n">df</span><span class="p">[</span><span class="n">index_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">index_column</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
            <span class="n">results_df</span><span class="p">[</span><span class="n">index_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="n">index_column</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
            <span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">results_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">index_column</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
            <span class="n">final_columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Category&quot;</span><span class="p">,</span> <span class="s2">&quot;Rationale&quot;</span><span class="p">]</span>
            <span class="n">merged_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="n">final_columns</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">merged_df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">handle_single_upload</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">zs_prompty</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">Config</span><span class="o">.</span><span class="n">ZS_PROMPTY</span><span class="p">),</span> <span class="n">fs_prompty</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">Config</span><span class="o">.</span><span class="n">FS_PROMPTY</span><span class="p">)</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The `handle_single_upload` function handles the uploading, processing, and categorization of a</span>
<span class="sd">        single CSV or XLSX file.</span>

<span class="sd">        Args:</span>
<span class="sd">          zs_prompty: The `zs_prompty` parameter in the `handle_single_upload` method is set to the value of</span>
<span class="sd">        `Path(Config.ZS_PROMPTY)`. This means that the `zs_prompty` parameter is a Path object initialized</span>
<span class="sd">        with the value of `Config.ZS_PROMPTY`.</span>
<span class="sd">          fs_prompty: The `fs_prompty` parameter in the `handle_single_upload` method is a Path object that</span>
<span class="sd">        is set to the value of `Config.FS_PROMPTY`. It is used as a default value for the parameter if no</span>
<span class="sd">        value is provided when calling the method. The purpose of this parameter is to</span>

<span class="sd">        Returns:</span>
<span class="sd">          The `handle_single_upload` method returns either None if the uploaded file is None or if there is</span>
<span class="sd">        an error processing the uploaded file. Otherwise, it does not explicitly return a value, but it</span>
<span class="sd">        performs various operations such as setting session state variables, processing the uploaded file,</span>
<span class="sd">        categorizing the data, and providing a download button for the results.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_file</span><span class="p">(</span>
            <span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">upload_message</span><span class="o">=</span><span class="s2">&quot;Upload your file&quot;</span><span class="p">,</span>
            <span class="n">file_types</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span> <span class="s2">&quot;xlsx&quot;</span><span class="p">],</span>
            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;single_file_uploader&quot;</span><span class="p">,</span>
            <span class="n">info_message</span><span class="o">=</span><span class="s2">&quot;Please upload a CSV or XLSX file to proceed.&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;uploaded_file_single&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">document_analysis_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_document_analysis_client</span><span class="p">()</span>
            <span class="n">upload_manager</span> <span class="o">=</span> <span class="n">StreamlitUploadManager</span><span class="p">(</span>
                <span class="n">file</span><span class="p">,</span> <span class="n">accept_multiple_files</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">document_analysis_client</span><span class="o">=</span><span class="n">document_analysis_client</span>
            <span class="p">)</span>
            <span class="n">file_data</span><span class="p">,</span> <span class="n">extension</span> <span class="o">=</span> <span class="n">upload_manager</span><span class="o">.</span><span class="n">process_upload</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;single_file_df&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_data</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error processing the uploaded file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;single_file_df&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;single_file_df&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Uploaded file: </span><span class="si">{</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_workflow</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;Categorize&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;tab1_submit&quot;</span><span class="p">):</span>
                <span class="n">merged_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categorize_data</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">zs_prompty</span><span class="p">,</span> <span class="n">fs_prompty</span><span class="p">)</span>
                <span class="n">csv_data</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">download_button</span><span class="p">(</span>
                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Download Results&quot;</span><span class="p">,</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">csv_data</span><span class="p">,</span>
                    <span class="n">file_name</span><span class="o">=</span><span class="s2">&quot;AI_Generated_Categorization.csv&quot;</span><span class="p">,</span>
                    <span class="n">mime</span><span class="o">=</span><span class="s2">&quot;text/csv&quot;</span><span class="p">,</span>
                <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_multiple_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uploaded_files</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The function `process_multiple_files` processes uploaded files using a document analysis client and</span>
<span class="sd">        returns the filenames and corresponding texts.</span>

<span class="sd">        Args:</span>
<span class="sd">          uploaded_files: Uploaded_files is a list of files that have been uploaded by the user. Each file</span>
<span class="sd">        in the list represents a file that the user has uploaded for processing.</span>

<span class="sd">        Returns:</span>
<span class="sd">          The `process_multiple_files` function returns two lists: `filenames` and `texts`. The `filenames`</span>
<span class="sd">        list contains the names of the uploaded files, while the `texts` list contains the processed data</span>
<span class="sd">        from the uploaded files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filenames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">texts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">document_analysis_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_document_analysis_client</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">uploaded_files</span><span class="p">:</span>
            <span class="n">upload_manager</span> <span class="o">=</span> <span class="n">StreamlitUploadManager</span><span class="p">(</span>
                <span class="n">file</span><span class="p">,</span> <span class="n">accept_multiple_files</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">document_analysis_client</span><span class="o">=</span><span class="n">document_analysis_client</span>
            <span class="p">)</span>
            <span class="n">file_data</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">upload_manager</span><span class="o">.</span><span class="n">process_upload</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">file_data</span><span class="p">:</span>
                <span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">filenames</span><span class="p">,</span> <span class="n">texts</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The function `process_results` displays categorization results with optional formatting options.</span>

<span class="sd">        Args:</span>
<span class="sd">          results: The `results` parameter in the `process_results` method is used to pass the results that</span>
<span class="sd">        need to be processed or displayed. It could be any data structure or information that the method</span>
<span class="sd">        needs to work with, such as a list, dictionary, string, etc.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Categorization Results:&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">handle_multiple_upload</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">zs_prompty</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">Config</span><span class="o">.</span><span class="n">ZS_PROMPTY</span><span class="p">),</span> <span class="n">fs_prompty</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">Config</span><span class="o">.</span><span class="n">FS_PROMPTY</span><span class="p">)</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The function `handle_multiple_upload` manages the upload and processing of multiple files,</span>
<span class="sd">        categorizes text excerpts, and processes the categorization results using either a few-shot or</span>
<span class="sd">        zero-shot categorizer.</span>

<span class="sd">        Args:</span>
<span class="sd">          zs_prompty: The `zs_prompty` parameter in the `handle_multiple_upload` function is a Path object</span>
<span class="sd">        that represents the path to the ZS_PROMPTY configuration in the Config module. It is used as a</span>
<span class="sd">        default value for the `prompty_path` parameter when initializing a ZeroShotCategorizer object in</span>
<span class="sd">          fs_prompty: The `fs_prompty` parameter in the `handle_multiple_upload` function seems to be a Path</span>
<span class="sd">        object that is initialized with the value from `Config.FS_PROMPTY`. It is used as the `prompty_path`</span>
<span class="sd">        parameter when creating instances of `FewShotCategorizer` or `ZeroShotCategorizer`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Provide a &quot;Clear All&quot; option as before.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;Clear All&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;multi_clear_all&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;uploaded_files_multiple&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">:</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;uploaded_files_multiple&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;processed_files_multiple&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">:</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;processed_files_multiple&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">rerun</span><span class="p">()</span>

        <span class="c1"># Use the common file uploader helper for multiple files.</span>
        <span class="n">files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_file</span><span class="p">(</span>
            <span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">upload_message</span><span class="o">=</span><span class="s2">&quot;Upload your files&quot;</span><span class="p">,</span>
            <span class="n">file_types</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;docx&quot;</span><span class="p">,</span> <span class="s2">&quot;pdf&quot;</span><span class="p">],</span>
            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;multiple_file_uploader&quot;</span><span class="p">,</span>
            <span class="n">info_message</span><span class="o">=</span><span class="s2">&quot;Please upload DOCX or PDF files to proceed.&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">files</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;uploaded_files_multiple&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">files</span>
            <span class="n">file_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">file</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="n">files</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Uploaded files: </span><span class="si">{</span><span class="n">file_names</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">filenames</span><span class="p">,</span> <span class="n">texts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_multiple_files</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;processed_files_multiple&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">filenames</span><span class="p">,</span> <span class="n">texts</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;processed_files_multiple&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">filenames</span><span class="p">,</span> <span class="n">texts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;processed_files_multiple&quot;</span><span class="p">]</span>
            <span class="n">text_to_label</span> <span class="o">=</span> <span class="n">texts</span>
            <span class="n">categories_dict</span><span class="p">,</span> <span class="n">examples</span> <span class="o">=</span> <span class="n">CategoryManager</span><span class="o">.</span><span class="n">define_categories</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="p">,</span> <span class="s2">&quot;tab2&quot;</span><span class="p">,</span> <span class="n">get_file_examples</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Texts (excerpts) to label:&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">text_to_label</span><span class="p">[:</span><span class="mi">5</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">[:</span><span class="mi">250</span><span class="p">])</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;Categorize&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;tab2_submit&quot;</span><span class="p">):</span>
                <span class="n">categorized_results</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="n">examples</span><span class="p">:</span>
                    <span class="n">categorization_request</span> <span class="o">=</span> <span class="n">CategoryManager</span><span class="o">.</span><span class="n">create_request</span><span class="p">(</span>
                        <span class="n">filenames</span><span class="p">,</span> <span class="n">text_to_label</span><span class="p">,</span> <span class="n">categories_dict</span><span class="p">,</span> <span class="n">examples</span>
                    <span class="p">)</span>
                    <span class="n">few_shot_categorizer</span> <span class="o">=</span> <span class="n">FewShotCategorizer</span><span class="p">(</span>
                        <span class="n">prompty_path</span><span class="o">=</span><span class="n">fs_prompty</span><span class="p">,</span> <span class="n">category_request</span><span class="o">=</span><span class="n">categorization_request</span>
                    <span class="p">)</span>
                    <span class="n">categorized_results</span> <span class="o">=</span> <span class="n">few_shot_categorizer</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">categorization_request</span> <span class="o">=</span> <span class="n">CategoryManager</span><span class="o">.</span><span class="n">create_request</span><span class="p">(</span>
                        <span class="n">filenames</span><span class="p">,</span> <span class="n">text_to_label</span><span class="p">,</span> <span class="n">categories_dict</span>
                    <span class="p">)</span>
                    <span class="n">zero_shot_categorizer</span> <span class="o">=</span> <span class="n">ZeroShotCategorizer</span><span class="p">(</span>
                        <span class="n">prompty_path</span><span class="o">=</span><span class="n">zs_prompty</span><span class="p">,</span> <span class="n">category_request</span><span class="o">=</span><span class="n">categorization_request</span>
                    <span class="p">)</span>
                    <span class="n">categorized_results</span> <span class="o">=</span> <span class="n">zero_shot_categorizer</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">process_results</span><span class="p">(</span><span class="n">categorized_results</span><span class="p">,</span> <span class="n">replace_newlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="LabeLMaker.streamlit_interface.CategorizeHandler.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">ui_helper</span><span class="p">,</span> <span class="n">azure_key</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The function initializes a class instance with a UI helper and an optional Azure key for file
management and configuration.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>ui_helper</code></b>
              –
              <div class="doc-md-description">
                <p>The <code>ui_helper</code> parameter is an object that provides helper</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>functions or utilities related to user interface operations. It is being passed to the constructor
of the current class as an argument.
  azure_key: The <code>azure_key</code> parameter is an optional parameter that can be passed to the <code>__init__</code>
method of a class. It is used to provide an Azure key that may be required for certain operations
within the class. If a value is provided for <code>azure_key</code>, it will be used to</p>


            <details class="quote">
              <summary>Source code in <code>LabeLMaker/streamlit_interface.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ui_helper</span><span class="p">,</span> <span class="n">azure_key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The function initializes a class instance with a UI helper and an optional Azure key for file</span>
<span class="sd">    management and configuration.</span>

<span class="sd">    Args:</span>
<span class="sd">      ui_helper: The `ui_helper` parameter is an object that provides helper</span>
<span class="sd">    functions or utilities related to user interface operations. It is being passed to the constructor</span>
<span class="sd">    of the current class as an argument.</span>
<span class="sd">      azure_key: The `azure_key` parameter is an optional parameter that can be passed to the `__init__`</span>
<span class="sd">    method of a class. It is used to provide an Azure key that may be required for certain operations</span>
<span class="sd">    within the class. If a value is provided for `azure_key`, it will be used to</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ui_helper</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fm</span> <span class="o">=</span> <span class="n">FileManager</span><span class="p">(</span><span class="n">azure_key</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">Config</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="LabeLMaker.streamlit_interface.CategorizeHandler.categorize_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">categorize_data</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">zs_prompty</span><span class="p">,</span> <span class="n">fs_prompty</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The function categorizes data based on specified parameters, using different techniques such as
Zero Shot, Few Shot, and Many Shot categorization.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>df</code></b>
              –
              <div class="doc-md-description">
                <p>The <code>df</code> parameter in the <code>categorize_data</code> function is typically a pandas DataFrame</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>containing the data that needs to be categorized. This DataFrame should include columns with the
data to be categorized, as well as any additional columns required for the categorization
process such as unique identifiers, ground truth labels
  params: The <code>params</code> dictionary contains the following keys and their corresponding values:
  zs_prompty: The <code>zs_prompty</code> parameter in the code snippet refers to the path of the Zero Shot
categorization model that will be used in the workflow. This model is utilized for performing
Zero Shot categorization, where the model predicts categories for data points without any prior
training on those specific categories.
  fs_prompty: The <code>fs_prompty</code> parameter in the provided code snippet is used as the path to the
Few-Shot Categorizer model for categorizing data. This path is utilized when running the
workflow for Few Shot categorization within the <code>categorize_data</code> method. The Few-Shot Categor</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>The <code>categorize_data</code> function returns a DataFrame <code>merged_df</code> that contains the original data</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>along with additional columns for predicted category and rationale based on the categorization
process specified in the function. The specific columns added to <code>merged_df</code> depend on the
categorization mode chosen (Evaluation or Production) and the evaluation techniques used (Zero
Shot, Few Shot, Many Shot).</p>


            <details class="quote">
              <summary>Source code in <code>LabeLMaker/streamlit_interface.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">categorize_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">zs_prompty</span><span class="p">,</span> <span class="n">fs_prompty</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The function categorizes data based on specified parameters, using different techniques such as</span>
<span class="sd">    Zero Shot, Few Shot, and Many Shot categorization.</span>

<span class="sd">    Args:</span>
<span class="sd">      df: The `df` parameter in the `categorize_data` function is typically a pandas DataFrame</span>
<span class="sd">    containing the data that needs to be categorized. This DataFrame should include columns with the</span>
<span class="sd">    data to be categorized, as well as any additional columns required for the categorization</span>
<span class="sd">    process such as unique identifiers, ground truth labels</span>
<span class="sd">      params: The `params` dictionary contains the following keys and their corresponding values:</span>
<span class="sd">      zs_prompty: The `zs_prompty` parameter in the code snippet refers to the path of the Zero Shot</span>
<span class="sd">    categorization model that will be used in the workflow. This model is utilized for performing</span>
<span class="sd">    Zero Shot categorization, where the model predicts categories for data points without any prior</span>
<span class="sd">    training on those specific categories.</span>
<span class="sd">      fs_prompty: The `fs_prompty` parameter in the provided code snippet is used as the path to the</span>
<span class="sd">    Few-Shot Categorizer model for categorizing data. This path is utilized when running the</span>
<span class="sd">    workflow for Few Shot categorization within the `categorize_data` method. The Few-Shot Categor</span>

<span class="sd">    Returns:</span>
<span class="sd">      The `categorize_data` function returns a DataFrame `merged_df` that contains the original data</span>
<span class="sd">    along with additional columns for predicted category and rationale based on the categorization</span>
<span class="sd">    process specified in the function. The specific columns added to `merged_df` depend on the</span>
<span class="sd">    categorization mode chosen (Evaluation or Production) and the evaluation techniques used (Zero</span>
<span class="sd">    Shot, Few Shot, Many Shot).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">index_column</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;index_column&quot;</span><span class="p">]</span>
    <span class="n">cat_col</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;categorizing_column&quot;</span><span class="p">]</span>
    <span class="n">mode_choice</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">index_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Unique ID column &#39;</span><span class="si">{</span><span class="n">index_column</span><span class="si">}</span><span class="s2">&#39; was not found. Creating new column &#39;</span><span class="si">{</span><span class="n">index_column</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
        <span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="n">index_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;selected_id_column&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">index_column</span>

    <span class="n">categories_dict</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;categories_dict&quot;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="n">text_to_label</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">cat_col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">unique_ids</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">index_column</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">mode_choice</span> <span class="o">==</span> <span class="s2">&quot;Evaluation&quot;</span><span class="p">:</span>
        <span class="n">categorization_request</span> <span class="o">=</span> <span class="n">CategoryManager</span><span class="o">.</span><span class="n">create_request</span><span class="p">(</span>
            <span class="n">unique_ids</span><span class="p">,</span> <span class="n">text_to_label</span><span class="p">,</span> <span class="n">categories_dict</span>
        <span class="p">)</span>
        <span class="n">gt_column</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ground_truth_column&quot;</span><span class="p">]</span>
        <span class="n">eval_techniques</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;evaluation_techniques&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Zero Shot&quot;</span><span class="p">])</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">few_shot_count</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;few_shot_count&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">many_shot_train_ratio</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;many_shot_train_ratio&quot;</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
        <span class="p">(</span>
            <span class="n">few_shot_examples</span><span class="p">,</span>
            <span class="n">few_shot_ids</span><span class="p">,</span>
            <span class="n">many_shot_examples</span><span class="p">,</span>
            <span class="n">many_shot_test_ids</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_ground_truth_examples</span><span class="p">(</span>
            <span class="n">df</span><span class="p">,</span> <span class="n">index_column</span><span class="p">,</span> <span class="n">cat_col</span><span class="p">,</span> <span class="n">gt_column</span><span class="p">,</span> <span class="n">few_shot_count</span><span class="p">,</span> <span class="n">many_shot_train_ratio</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">technique</span> <span class="ow">in</span> <span class="n">eval_techniques</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">technique</span> <span class="o">==</span> <span class="s2">&quot;Zero Shot&quot;</span><span class="p">:</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="s2">&quot;Running workflow (Zero Shot categorization)...&quot;</span><span class="p">):</span>
                    <span class="n">categorizer</span> <span class="o">=</span> <span class="n">ZeroShotCategorizer</span><span class="p">(</span>
                        <span class="n">prompty_path</span><span class="o">=</span><span class="n">zs_prompty</span><span class="p">,</span> <span class="n">category_request</span><span class="o">=</span><span class="n">categorization_request</span>
                    <span class="p">)</span>
                    <span class="n">results</span> <span class="o">=</span> <span class="n">categorizer</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
                <span class="n">predictions</span><span class="p">[</span><span class="s2">&quot;Zero Shot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span>
            <span class="k">elif</span> <span class="n">technique</span> <span class="o">==</span> <span class="s2">&quot;Few Shot&quot;</span><span class="p">:</span>
                <span class="n">few_shot_request</span> <span class="o">=</span> <span class="n">CategoryManager</span><span class="o">.</span><span class="n">create_request</span><span class="p">(</span>
                    <span class="n">unique_ids</span><span class="p">,</span> <span class="n">text_to_label</span><span class="p">,</span> <span class="n">categories_dict</span><span class="p">,</span> <span class="n">few_shot_examples</span>
                <span class="p">)</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="s2">&quot;Running workflow (Few Shot categorization)...&quot;</span><span class="p">):</span>
                    <span class="n">categorizer</span> <span class="o">=</span> <span class="n">FewShotCategorizer</span><span class="p">(</span>
                        <span class="n">prompty_path</span><span class="o">=</span><span class="n">fs_prompty</span><span class="p">,</span> <span class="n">category_request</span><span class="o">=</span><span class="n">few_shot_request</span>
                    <span class="p">)</span>
                    <span class="n">results</span> <span class="o">=</span> <span class="n">categorizer</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
                <span class="n">filtered_results</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">few_shot_ids</span><span class="p">]</span>
                <span class="n">predictions</span><span class="p">[</span><span class="s2">&quot;Few Shot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtered_results</span>
            <span class="k">elif</span> <span class="n">technique</span> <span class="o">==</span> <span class="s2">&quot;Many Shot&quot;</span><span class="p">:</span>
                <span class="n">many_shot_request</span> <span class="o">=</span> <span class="n">CategoryManager</span><span class="o">.</span><span class="n">create_request</span><span class="p">(</span>
                    <span class="n">unique_ids</span><span class="p">,</span> <span class="n">text_to_label</span><span class="p">,</span> <span class="n">categories_dict</span><span class="p">,</span> <span class="n">many_shot_examples</span>
                <span class="p">)</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="s2">&quot;Running workflow (Many Shot categorization)...&quot;</span><span class="p">):</span>
                    <span class="n">categorizer</span> <span class="o">=</span> <span class="n">ManyshotClassifier</span><span class="p">(</span>
                        <span class="n">categorization_request</span><span class="o">=</span><span class="n">many_shot_request</span><span class="p">,</span>
                        <span class="n">min_class_count</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">MIN_SAMPLES_MANY_SHOT</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">results</span> <span class="o">=</span> <span class="n">categorizer</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
                <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">in</span> <span class="n">many_shot_test_ids</span><span class="p">]</span>
                <span class="n">predictions</span><span class="p">[</span><span class="s2">&quot;Many Shot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span>

        <span class="n">merged_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">tech</span><span class="p">,</span> <span class="n">results</span> <span class="ow">in</span> <span class="n">predictions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">tech_pred_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="p">[(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">],</span>
                <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">index_column</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Predicted Category (</span><span class="si">{</span><span class="n">tech</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Rationale (</span><span class="si">{</span><span class="n">tech</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="n">merged_df</span><span class="p">[</span><span class="n">index_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="n">index_column</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
            <span class="n">tech_pred_df</span><span class="p">[</span><span class="n">index_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">tech_pred_df</span><span class="p">[</span><span class="n">index_column</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
            <span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">merged_df</span><span class="p">,</span> <span class="n">tech_pred_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">index_column</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">merged_df</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">gt_column</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ground_truth_column&quot;</span><span class="p">]</span>
        <span class="n">all_examples</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">text</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">gt</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">text</span><span class="p">,</span> <span class="n">gt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">cat_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">gt_column</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">gt</span>
        <span class="p">]</span>
        <span class="n">categorization_request</span> <span class="o">=</span> <span class="n">CategoryManager</span><span class="o">.</span><span class="n">create_request</span><span class="p">(</span>
            <span class="n">unique_ids</span><span class="p">,</span> <span class="n">text_to_label</span><span class="p">,</span> <span class="n">categories_dict</span><span class="p">,</span> <span class="n">all_examples</span>
        <span class="p">)</span>
        <span class="n">num_examples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_examples</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of examples provided: </span><span class="si">{</span><span class="n">num_examples</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">categorized_results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">num_examples</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="s2">&quot;Running workflow (Zero-Shot Production)...&quot;</span><span class="p">):</span>
                <span class="n">categorizer</span> <span class="o">=</span> <span class="n">ZeroShotCategorizer</span><span class="p">(</span>
                    <span class="n">prompty_path</span><span class="o">=</span><span class="n">zs_prompty</span><span class="p">,</span> <span class="n">category_request</span><span class="o">=</span><span class="n">categorization_request</span>
                <span class="p">)</span>
                <span class="n">categorized_results</span> <span class="o">=</span> <span class="n">categorizer</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">num_examples</span> <span class="o">&lt;</span> <span class="n">Config</span><span class="o">.</span><span class="n">MIN_SAMPLES_MANY_SHOT</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="s2">&quot;Running workflow (Few-Shot Production)...&quot;</span><span class="p">):</span>
                <span class="n">categorizer</span> <span class="o">=</span> <span class="n">FewShotCategorizer</span><span class="p">(</span>
                    <span class="n">prompty_path</span><span class="o">=</span><span class="n">fs_prompty</span><span class="p">,</span> <span class="n">category_request</span><span class="o">=</span><span class="n">categorization_request</span>
                <span class="p">)</span>
                <span class="n">categorized_results</span> <span class="o">=</span> <span class="n">categorizer</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">label_counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">gt_column</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
            <span class="n">min_class_samples</span> <span class="o">=</span> <span class="n">label_counts</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">label_counts</span><span class="o">.</span><span class="n">empty</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="s2">&quot;Running workflow (Many-Shot Production)...&quot;</span><span class="p">):</span>
                <span class="n">categorizer</span> <span class="o">=</span> <span class="n">ManyshotClassifier</span><span class="p">(</span>
                    <span class="n">categorization_request</span><span class="o">=</span><span class="n">categorization_request</span><span class="p">,</span>
                    <span class="n">min_class_count</span><span class="o">=</span><span class="n">min_class_samples</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">categorized_results</span> <span class="o">=</span> <span class="n">categorizer</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
        <span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">[(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">categorized_results</span><span class="p">],</span>
            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">index_column</span><span class="p">,</span> <span class="s2">&quot;Category&quot;</span><span class="p">,</span> <span class="s2">&quot;Rationale&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="n">index_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">index_column</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
        <span class="n">results_df</span><span class="p">[</span><span class="n">index_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="n">index_column</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
        <span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">results_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">index_column</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
        <span class="n">final_columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Category&quot;</span><span class="p">,</span> <span class="s2">&quot;Rationale&quot;</span><span class="p">]</span>
        <span class="n">merged_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="n">final_columns</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">merged_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="LabeLMaker.streamlit_interface.CategorizeHandler.get_document_analysis_client" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_document_analysis_client</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This function returns a valid document analysis client based on the configuration provided.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>A valid document analysis client based on the configuration is being returned if the condition `if</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>hasattr(self.config, "AZURE_DOCAI_KEY") and self.config.AZURE_DOCAI_KEY<code>is met. Otherwise,</code>None`
is returned.</p>


            <details class="quote">
              <summary>Source code in <code>LabeLMaker/streamlit_interface.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_document_analysis_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function returns a valid document analysis client based on the configuration provided.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A valid document analysis client based on the configuration is being returned if the condition `if</span>
<span class="sd">    hasattr(self.config, &quot;AZURE_DOCAI_KEY&quot;) and self.config.AZURE_DOCAI_KEY` is met. Otherwise, `None`</span>
<span class="sd">    is returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span> <span class="s2">&quot;AZURE_DOCAI_KEY&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">AZURE_DOCAI_KEY</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">create_document_analysis_client</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">AZURE_DOCAI_KEY</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="LabeLMaker.streamlit_interface.CategorizeHandler.handle_multiple_upload" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">handle_multiple_upload</span><span class="p">(</span><span class="n">zs_prompty</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">Config</span><span class="o">.</span><span class="n">ZS_PROMPTY</span><span class="p">),</span> <span class="n">fs_prompty</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">Config</span><span class="o">.</span><span class="n">FS_PROMPTY</span><span class="p">))</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The function <code>handle_multiple_upload</code> manages the upload and processing of multiple files,
categorizes text excerpts, and processes the categorization results using either a few-shot or
zero-shot categorizer.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>zs_prompty</code></b>
              –
              <div class="doc-md-description">
                <p>The <code>zs_prompty</code> parameter in the <code>handle_multiple_upload</code> function is a Path object</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>that represents the path to the ZS_PROMPTY configuration in the Config module. It is used as a
default value for the <code>prompty_path</code> parameter when initializing a ZeroShotCategorizer object in
  fs_prompty: The <code>fs_prompty</code> parameter in the <code>handle_multiple_upload</code> function seems to be a Path
object that is initialized with the value from <code>Config.FS_PROMPTY</code>. It is used as the <code>prompty_path</code>
parameter when creating instances of <code>FewShotCategorizer</code> or <code>ZeroShotCategorizer</code></p>


            <details class="quote">
              <summary>Source code in <code>LabeLMaker/streamlit_interface.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">handle_multiple_upload</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">zs_prompty</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">Config</span><span class="o">.</span><span class="n">ZS_PROMPTY</span><span class="p">),</span> <span class="n">fs_prompty</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">Config</span><span class="o">.</span><span class="n">FS_PROMPTY</span><span class="p">)</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The function `handle_multiple_upload` manages the upload and processing of multiple files,</span>
<span class="sd">    categorizes text excerpts, and processes the categorization results using either a few-shot or</span>
<span class="sd">    zero-shot categorizer.</span>

<span class="sd">    Args:</span>
<span class="sd">      zs_prompty: The `zs_prompty` parameter in the `handle_multiple_upload` function is a Path object</span>
<span class="sd">    that represents the path to the ZS_PROMPTY configuration in the Config module. It is used as a</span>
<span class="sd">    default value for the `prompty_path` parameter when initializing a ZeroShotCategorizer object in</span>
<span class="sd">      fs_prompty: The `fs_prompty` parameter in the `handle_multiple_upload` function seems to be a Path</span>
<span class="sd">    object that is initialized with the value from `Config.FS_PROMPTY`. It is used as the `prompty_path`</span>
<span class="sd">    parameter when creating instances of `FewShotCategorizer` or `ZeroShotCategorizer`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Provide a &quot;Clear All&quot; option as before.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;Clear All&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;multi_clear_all&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;uploaded_files_multiple&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;uploaded_files_multiple&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;processed_files_multiple&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;processed_files_multiple&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">rerun</span><span class="p">()</span>

    <span class="c1"># Use the common file uploader helper for multiple files.</span>
    <span class="n">files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_file</span><span class="p">(</span>
        <span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">upload_message</span><span class="o">=</span><span class="s2">&quot;Upload your files&quot;</span><span class="p">,</span>
        <span class="n">file_types</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;docx&quot;</span><span class="p">,</span> <span class="s2">&quot;pdf&quot;</span><span class="p">],</span>
        <span class="n">key</span><span class="o">=</span><span class="s2">&quot;multiple_file_uploader&quot;</span><span class="p">,</span>
        <span class="n">info_message</span><span class="o">=</span><span class="s2">&quot;Please upload DOCX or PDF files to proceed.&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">files</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;uploaded_files_multiple&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">files</span>
        <span class="n">file_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">file</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="n">files</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Uploaded files: </span><span class="si">{</span><span class="n">file_names</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">filenames</span><span class="p">,</span> <span class="n">texts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_multiple_files</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;processed_files_multiple&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">filenames</span><span class="p">,</span> <span class="n">texts</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;processed_files_multiple&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">filenames</span><span class="p">,</span> <span class="n">texts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;processed_files_multiple&quot;</span><span class="p">]</span>
        <span class="n">text_to_label</span> <span class="o">=</span> <span class="n">texts</span>
        <span class="n">categories_dict</span><span class="p">,</span> <span class="n">examples</span> <span class="o">=</span> <span class="n">CategoryManager</span><span class="o">.</span><span class="n">define_categories</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="p">,</span> <span class="s2">&quot;tab2&quot;</span><span class="p">,</span> <span class="n">get_file_examples</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Texts (excerpts) to label:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">text_to_label</span><span class="p">[:</span><span class="mi">5</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">[:</span><span class="mi">250</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;Categorize&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;tab2_submit&quot;</span><span class="p">):</span>
            <span class="n">categorized_results</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">examples</span><span class="p">:</span>
                <span class="n">categorization_request</span> <span class="o">=</span> <span class="n">CategoryManager</span><span class="o">.</span><span class="n">create_request</span><span class="p">(</span>
                    <span class="n">filenames</span><span class="p">,</span> <span class="n">text_to_label</span><span class="p">,</span> <span class="n">categories_dict</span><span class="p">,</span> <span class="n">examples</span>
                <span class="p">)</span>
                <span class="n">few_shot_categorizer</span> <span class="o">=</span> <span class="n">FewShotCategorizer</span><span class="p">(</span>
                    <span class="n">prompty_path</span><span class="o">=</span><span class="n">fs_prompty</span><span class="p">,</span> <span class="n">category_request</span><span class="o">=</span><span class="n">categorization_request</span>
                <span class="p">)</span>
                <span class="n">categorized_results</span> <span class="o">=</span> <span class="n">few_shot_categorizer</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">categorization_request</span> <span class="o">=</span> <span class="n">CategoryManager</span><span class="o">.</span><span class="n">create_request</span><span class="p">(</span>
                    <span class="n">filenames</span><span class="p">,</span> <span class="n">text_to_label</span><span class="p">,</span> <span class="n">categories_dict</span>
                <span class="p">)</span>
                <span class="n">zero_shot_categorizer</span> <span class="o">=</span> <span class="n">ZeroShotCategorizer</span><span class="p">(</span>
                    <span class="n">prompty_path</span><span class="o">=</span><span class="n">zs_prompty</span><span class="p">,</span> <span class="n">category_request</span><span class="o">=</span><span class="n">categorization_request</span>
                <span class="p">)</span>
                <span class="n">categorized_results</span> <span class="o">=</span> <span class="n">zero_shot_categorizer</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process_results</span><span class="p">(</span><span class="n">categorized_results</span><span class="p">,</span> <span class="n">replace_newlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="LabeLMaker.streamlit_interface.CategorizeHandler.handle_single_upload" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">handle_single_upload</span><span class="p">(</span><span class="n">zs_prompty</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">Config</span><span class="o">.</span><span class="n">ZS_PROMPTY</span><span class="p">),</span> <span class="n">fs_prompty</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">Config</span><span class="o">.</span><span class="n">FS_PROMPTY</span><span class="p">))</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The <code>handle_single_upload</code> function handles the uploading, processing, and categorization of a
single CSV or XLSX file.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>zs_prompty</code></b>
              –
              <div class="doc-md-description">
                <p>The <code>zs_prompty</code> parameter in the <code>handle_single_upload</code> method is set to the value of</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p><code>Path(Config.ZS_PROMPTY)</code>. This means that the <code>zs_prompty</code> parameter is a Path object initialized
with the value of <code>Config.ZS_PROMPTY</code>.
  fs_prompty: The <code>fs_prompty</code> parameter in the <code>handle_single_upload</code> method is a Path object that
is set to the value of <code>Config.FS_PROMPTY</code>. It is used as a default value for the parameter if no
value is provided when calling the method. The purpose of this parameter is to</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>The <code>handle_single_upload</code> method returns either None if the uploaded file is None or if there is</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>an error processing the uploaded file. Otherwise, it does not explicitly return a value, but it
performs various operations such as setting session state variables, processing the uploaded file,
categorizing the data, and providing a download button for the results.</p>


            <details class="quote">
              <summary>Source code in <code>LabeLMaker/streamlit_interface.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">handle_single_upload</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">zs_prompty</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">Config</span><span class="o">.</span><span class="n">ZS_PROMPTY</span><span class="p">),</span> <span class="n">fs_prompty</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">Config</span><span class="o">.</span><span class="n">FS_PROMPTY</span><span class="p">)</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The `handle_single_upload` function handles the uploading, processing, and categorization of a</span>
<span class="sd">    single CSV or XLSX file.</span>

<span class="sd">    Args:</span>
<span class="sd">      zs_prompty: The `zs_prompty` parameter in the `handle_single_upload` method is set to the value of</span>
<span class="sd">    `Path(Config.ZS_PROMPTY)`. This means that the `zs_prompty` parameter is a Path object initialized</span>
<span class="sd">    with the value of `Config.ZS_PROMPTY`.</span>
<span class="sd">      fs_prompty: The `fs_prompty` parameter in the `handle_single_upload` method is a Path object that</span>
<span class="sd">    is set to the value of `Config.FS_PROMPTY`. It is used as a default value for the parameter if no</span>
<span class="sd">    value is provided when calling the method. The purpose of this parameter is to</span>

<span class="sd">    Returns:</span>
<span class="sd">      The `handle_single_upload` method returns either None if the uploaded file is None or if there is</span>
<span class="sd">    an error processing the uploaded file. Otherwise, it does not explicitly return a value, but it</span>
<span class="sd">    performs various operations such as setting session state variables, processing the uploaded file,</span>
<span class="sd">    categorizing the data, and providing a download button for the results.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_file</span><span class="p">(</span>
        <span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">upload_message</span><span class="o">=</span><span class="s2">&quot;Upload your file&quot;</span><span class="p">,</span>
        <span class="n">file_types</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span> <span class="s2">&quot;xlsx&quot;</span><span class="p">],</span>
        <span class="n">key</span><span class="o">=</span><span class="s2">&quot;single_file_uploader&quot;</span><span class="p">,</span>
        <span class="n">info_message</span><span class="o">=</span><span class="s2">&quot;Please upload a CSV or XLSX file to proceed.&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;uploaded_file_single&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">document_analysis_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_document_analysis_client</span><span class="p">()</span>
        <span class="n">upload_manager</span> <span class="o">=</span> <span class="n">StreamlitUploadManager</span><span class="p">(</span>
            <span class="n">file</span><span class="p">,</span> <span class="n">accept_multiple_files</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">document_analysis_client</span><span class="o">=</span><span class="n">document_analysis_client</span>
        <span class="p">)</span>
        <span class="n">file_data</span><span class="p">,</span> <span class="n">extension</span> <span class="o">=</span> <span class="n">upload_manager</span><span class="o">.</span><span class="n">process_upload</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;single_file_df&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_data</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error processing the uploaded file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;single_file_df&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;single_file_df&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Uploaded file: </span><span class="si">{</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_workflow</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;Categorize&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;tab1_submit&quot;</span><span class="p">):</span>
            <span class="n">merged_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categorize_data</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">zs_prompty</span><span class="p">,</span> <span class="n">fs_prompty</span><span class="p">)</span>
            <span class="n">csv_data</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">download_button</span><span class="p">(</span>
                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Download Results&quot;</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">csv_data</span><span class="p">,</span>
                <span class="n">file_name</span><span class="o">=</span><span class="s2">&quot;AI_Generated_Categorization.csv&quot;</span><span class="p">,</span>
                <span class="n">mime</span><span class="o">=</span><span class="s2">&quot;text/csv&quot;</span><span class="p">,</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="LabeLMaker.streamlit_interface.CategorizeHandler.process_multiple_files" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_multiple_files</span><span class="p">(</span><span class="n">uploaded_files</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The function <code>process_multiple_files</code> processes uploaded files using a document analysis client and
returns the filenames and corresponding texts.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>uploaded_files</code></b>
              –
              <div class="doc-md-description">
                <p>Uploaded_files is a list of files that have been uploaded by the user. Each file</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>in the list represents a file that the user has uploaded for processing.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>The <code>process_multiple_files</code> function returns two lists: <code>filenames</code> and <code>texts</code>. The <code>filenames</code></p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>list contains the names of the uploaded files, while the <code>texts</code> list contains the processed data
from the uploaded files.</p>


            <details class="quote">
              <summary>Source code in <code>LabeLMaker/streamlit_interface.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">process_multiple_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uploaded_files</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The function `process_multiple_files` processes uploaded files using a document analysis client and</span>
<span class="sd">    returns the filenames and corresponding texts.</span>

<span class="sd">    Args:</span>
<span class="sd">      uploaded_files: Uploaded_files is a list of files that have been uploaded by the user. Each file</span>
<span class="sd">    in the list represents a file that the user has uploaded for processing.</span>

<span class="sd">    Returns:</span>
<span class="sd">      The `process_multiple_files` function returns two lists: `filenames` and `texts`. The `filenames`</span>
<span class="sd">    list contains the names of the uploaded files, while the `texts` list contains the processed data</span>
<span class="sd">    from the uploaded files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filenames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">document_analysis_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_document_analysis_client</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">uploaded_files</span><span class="p">:</span>
        <span class="n">upload_manager</span> <span class="o">=</span> <span class="n">StreamlitUploadManager</span><span class="p">(</span>
            <span class="n">file</span><span class="p">,</span> <span class="n">accept_multiple_files</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">document_analysis_client</span><span class="o">=</span><span class="n">document_analysis_client</span>
        <span class="p">)</span>
        <span class="n">file_data</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">upload_manager</span><span class="o">.</span><span class="n">process_upload</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">file_data</span><span class="p">:</span>
            <span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">filenames</span><span class="p">,</span> <span class="n">texts</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="LabeLMaker.streamlit_interface.CategorizeHandler.process_results" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_results</span><span class="p">(</span><span class="n">results</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The function <code>process_results</code> displays categorization results with optional formatting options.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>results</code></b>
              –
              <div class="doc-md-description">
                <p>The <code>results</code> parameter in the <code>process_results</code> method is used to pass the results that</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>need to be processed or displayed. It could be any data structure or information that the method
needs to work with, such as a list, dictionary, string, etc.</p>


            <details class="quote">
              <summary>Source code in <code>LabeLMaker/streamlit_interface.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">process_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The function `process_results` displays categorization results with optional formatting options.</span>

<span class="sd">    Args:</span>
<span class="sd">      results: The `results` parameter in the `process_results` method is used to pass the results that</span>
<span class="sd">    need to be processed or displayed. It could be any data structure or information that the method</span>
<span class="sd">    needs to work with, such as a list, dictionary, string, etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Categorization Results:&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="LabeLMaker.streamlit_interface.CategorizeHandler.setup_workflow" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">setup_workflow</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The <code>setup_workflow</code> function in Python sets up parameters for a workflow, including selecting
columns, creating unique identifiers, and choosing evaluation approaches.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>df</code></b>
              –
              <div class="doc-md-description">
                <p>The <code>setup_workflow</code> function is designed to set up parameters for a workflow based on user</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>interactions with a UI. The function takes a DataFrame <code>df</code> as input and performs the following
tasks:</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>The <code>setup_workflow</code> function returns a dictionary <code>params</code> containing various parameters set</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>based on user inputs and selections made during the workflow setup process. The function collects
information such as the mode (Evaluation or Production), unique identifier column, categorizing
column, ground truth column, evaluation techniques selected, and related parameters for Few Shot and
Many Shot evaluation approaches. Additionally, it includes information about default categories and
descriptions</p>


            <details class="quote">
              <summary>Source code in <code>LabeLMaker/streamlit_interface.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">setup_workflow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The `setup_workflow` function in Python sets up parameters for a workflow, including selecting</span>
<span class="sd">    columns, creating unique identifiers, and choosing evaluation approaches.</span>

<span class="sd">    Args:</span>
<span class="sd">      df: The `setup_workflow` function is designed to set up parameters for a workflow based on user</span>
<span class="sd">    interactions with a UI. The function takes a DataFrame `df` as input and performs the following</span>
<span class="sd">    tasks:</span>

<span class="sd">    Returns:</span>
<span class="sd">      The `setup_workflow` function returns a dictionary `params` containing various parameters set</span>
<span class="sd">    based on user inputs and selections made during the workflow setup process. The function collects</span>
<span class="sd">    information such as the mode (Evaluation or Production), unique identifier column, categorizing</span>
<span class="sd">    column, ground truth column, evaluation techniques selected, and related parameters for Few Shot and</span>
<span class="sd">    Many Shot evaluation approaches. Additionally, it includes information about default categories and</span>
<span class="sd">    descriptions</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">advanced_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">checkbox</span><span class="p">(</span>
        <span class="s2">&quot;Advanced Mode&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;For users with ground truth labels. Check to run evaluation pipeline.&quot;</span><span class="p">,</span>
        <span class="n">key</span><span class="o">=</span><span class="s2">&quot;advanced_mode&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">advanced_mode</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Advanced Mode is activated: Users can select classification mode (e.g., zero shot, few shot, or many shot)&quot;</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Advanced Mode is not activated: Classification will be determined by number of examples provided&quot;</span>
        <span class="p">)</span>
    <span class="n">params</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Evaluation&quot;</span> <span class="k">if</span> <span class="n">advanced_mode</span> <span class="k">else</span> <span class="s2">&quot;Production&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;uniqueIdSetup_done&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;### Unique Identifier Setup&quot;</span><span class="p">)</span>
        <span class="n">id_choice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">radio</span><span class="p">(</span>
            <span class="s2">&quot;How would you like to specify a unique identifier?&quot;</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Create new ID column&quot;</span><span class="p">,</span> <span class="s2">&quot;Use an existing column&quot;</span><span class="p">],</span>
            <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;id_choice&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">id_choice</span> <span class="o">==</span> <span class="s2">&quot;Create new ID column&quot;</span><span class="p">:</span>
            <span class="n">new_id_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">text_input</span><span class="p">(</span>
                <span class="s2">&quot;Enter name for the new ID column&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;new_id_column&quot;</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;Create ID Column&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;create_id_column&quot;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">new_id_col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">new_id_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New ID column &#39;</span><span class="si">{</span><span class="n">new_id_col</span><span class="si">}</span><span class="s2">&#39; created.&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">new_id_col</span><span class="si">}</span><span class="s2">&#39; already exists; using it.&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;single_file_df&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;selected_id_column&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_id_col</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;uniqueIdSetup_done&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">selected_existing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span>
                <span class="s2">&quot;Select the column to use as the unique identifier&quot;</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">key</span><span class="o">=</span><span class="s2">&quot;existing_id_column&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;Confirm ID Column&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;confirm_id_column&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;selected_id_column&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_existing</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;uniqueIdSetup_done&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">sel_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;selected_id_column&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sel_id</span> <span class="ow">and</span> <span class="n">sel_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="n">sel_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;single_file_df&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span>
    <span class="n">params</span><span class="p">[</span><span class="s2">&quot;index_column&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;selected_id_column&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using &#39;</span><span class="si">{</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;index_column&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; as the unique identifier column.&quot;</span><span class="p">)</span>

    <span class="n">df_columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">params</span><span class="p">[</span><span class="s2">&quot;categorizing_column&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span>
        <span class="s2">&quot;Select the column with text data you want to label&quot;</span><span class="p">,</span>
        <span class="n">options</span><span class="o">=</span><span class="n">df_columns</span><span class="p">,</span>
        <span class="n">key</span><span class="o">=</span><span class="s2">&quot;categorizing_column&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;ground_truth_column&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;ground_truth_column&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">gt_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span>
        <span class="s2">&quot;Select the column with ground truth labels&quot;</span><span class="p">,</span>
        <span class="n">options</span><span class="o">=</span><span class="n">df_columns</span><span class="p">,</span>
        <span class="n">key</span><span class="o">=</span><span class="s2">&quot;ground_truth_column&quot;</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="n">df_columns</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;ground_truth_column&quot;</span><span class="p">]),</span>
    <span class="p">)</span>
    <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ground_truth_column&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gt_col</span>

    <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Evaluation&quot;</span><span class="p">:</span>
        <span class="n">eval_techniques</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">multiselect</span><span class="p">(</span>
            <span class="s2">&quot;Select the evaluation approaches to run:&quot;</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Zero Shot&quot;</span><span class="p">,</span> <span class="s2">&quot;Few Shot&quot;</span><span class="p">,</span> <span class="s2">&quot;Many Shot&quot;</span><span class="p">],</span>
            <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Zero Shot&quot;</span><span class="p">],</span>
            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;evaluation_techniques&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;evaluation_techniques&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eval_techniques</span>
        <span class="k">if</span> <span class="s2">&quot;Few Shot&quot;</span> <span class="ow">in</span> <span class="n">eval_techniques</span><span class="p">:</span>
            <span class="n">few_shot_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">number_input</span><span class="p">(</span>
                <span class="s2">&quot;Enter maximum examples per category (Few Shot)&quot;</span><span class="p">,</span>
                <span class="n">min_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">key</span><span class="o">=</span><span class="s2">&quot;few_shot_count&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;few_shot_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">few_shot_count</span>
        <span class="k">if</span> <span class="s2">&quot;Many Shot&quot;</span> <span class="ow">in</span> <span class="n">eval_techniques</span><span class="p">:</span>
            <span class="n">many_shot_train_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">number_input</span><span class="p">(</span>
                <span class="s2">&quot;Enter train proportion for Many Shot (0 to 1)&quot;</span><span class="p">,</span>
                <span class="n">min_value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                <span class="n">max_value</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">value</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                <span class="n">key</span><span class="o">=</span><span class="s2">&quot;many_shot_train_ratio&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;many_shot_train_ratio&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">many_shot_train_ratio</span>

    <span class="n">default_categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_default_categories</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">gt_col</span><span class="p">)</span>
    <span class="n">categories_dict</span><span class="p">,</span> <span class="n">categories_with_descriptions</span> <span class="o">=</span> <span class="n">CategoryManager</span><span class="o">.</span><span class="n">define_categories</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="p">,</span> <span class="s2">&quot;tab1&quot;</span><span class="p">,</span> <span class="n">unique_values_str</span><span class="o">=</span><span class="n">default_categories</span>
    <span class="p">)</span>
    <span class="n">params</span><span class="p">[</span><span class="s2">&quot;categories_dict&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">categories_dict</span>
    <span class="n">params</span><span class="p">[</span><span class="s2">&quot;categories_with_descriptions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">categories_with_descriptions</span>
    <span class="k">return</span> <span class="n">params</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="LabeLMaker.streamlit_interface.EvaluateHandler" class="doc doc-heading">
            <code>EvaluateHandler</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseHandler (LabeLMaker.streamlit_interface.BaseHandler)" href="#LabeLMaker.streamlit_interface.BaseHandler">BaseHandler</a></code></p>


        <p>Handles evaluation workflows.
Includes CSV file upload &amp; preview, evaluation setup,
single/multi‐column evaluation including method comparisons,
and DOCX report creation.</p>







              <details class="quote">
                <summary>Source code in <code>LabeLMaker/streamlit_interface.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">EvaluateHandler</span><span class="p">(</span><span class="n">BaseHandler</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles evaluation workflows.</span>
<span class="sd">    Includes CSV file upload &amp; preview, evaluation setup,</span>
<span class="sd">    single/multi‐column evaluation including method comparisons,</span>
<span class="sd">    and DOCX report creation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ui_helper</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The above function is a constructor that initializes an object with a UI helper.</span>

<span class="sd">        Args:</span>
<span class="sd">          ui_helper: The `ui_helper` parameter in the `__init__` method is typically used to pass in an</span>
<span class="sd">        object that provides utility functions or methods related to the user interface. This can</span>
<span class="sd">        include functions for displaying information, handling user input, managing UI components, and</span>
<span class="sd">        more. By passing in a `ui_helper</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ui_helper</span><span class="p">)</span>

    <span class="c1"># --------------------------</span>
    <span class="c1"># File Upload &amp; Data Loader Methods</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The function `load_data` creates a `DataLoader` object with the specified file and returns it.</span>

<span class="sd">        Args:</span>
<span class="sd">          file: The `file` parameter in the `load_data` method is the file path or name that you want to</span>
<span class="sd">        load data from. This parameter is used to specify the location of the file that the `DataLoader`</span>
<span class="sd">        will load data from.</span>

<span class="sd">        Returns:</span>
<span class="sd">          An instance of the DataLoader class with the specified file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">loader</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">preview_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loader</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The function `preview_data` displays a preview of the CSV data loaded by the `loader` object,</span>
<span class="sd">        including the first few rows and the total number of rows in the dataframe.</span>

<span class="sd">        Args:</span>
<span class="sd">          loader: The `loader` parameter in the `preview_data` method is likely an object that contains</span>
<span class="sd">        a DataFrame (`df`) attribute. This DataFrame is used to display a preview of the data in the CSV</span>
<span class="sd">        file being loaded. The method displays the first few rows of the DataFrame and the total number</span>
<span class="sd">        of rows in</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="s2">&quot;CSV Preview:&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">loader</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total rows in dataframe: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">loader</span><span class="o">.</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># --------------------------</span>
    <span class="c1"># Evaluation Setup Helpers</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">select_evaluation_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loader</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The function `select_evaluation_column` prompts the user to select a column from a DataFrame for</span>
<span class="sd">        use as the ground truth column.</span>

<span class="sd">        Args:</span>
<span class="sd">          loader: The `loader` parameter in the `select_evaluation_column` method seems to be an object</span>
<span class="sd">        that has a property `df` which is a DataFrame. The method allows the user to select a column</span>
<span class="sd">        from the DataFrame `loader.df` as the ground truth column. The user interface (UI) component</span>
<span class="sd">        used</span>

<span class="sd">        Returns:</span>
<span class="sd">          the column selected as the ground truth column from the DataFrame loaded by the loader.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ground_truth_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span>
            <span class="s2">&quot;Select Ground Truth Column&quot;</span><span class="p">,</span> <span class="n">loader</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;eval_gt_column&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">ground_truth_col</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_class_balance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loader</span><span class="p">,</span> <span class="n">class_col</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The function `check_class_balance` computes the class balance for a specified column in a</span>
<span class="sd">        DataFrame and displays the results using a UI subheader and table.</span>

<span class="sd">        Args:</span>
<span class="sd">          loader: The `loader` parameter is likely an object that helps load or manage data, such as a</span>
<span class="sd">        data loader object used in machine learning frameworks like PyTorch or TensorFlow. It is being</span>
<span class="sd">        used to access the data frame (`loader.df`) containing the dataset.</span>
<span class="sd">          class_col: The `class_col` parameter in the `check_class_balance` function is used to specify</span>
<span class="sd">        the column in the dataset that contains the class labels or categories for which you want to</span>
<span class="sd">        check the balance. This column will be used by the `ClassBalance` to compute the balance of the</span>
<span class="sd">        classes in the dataset</span>
<span class="sd">          label: The `label` parameter is a string that represents the label or title of the class</span>
<span class="sd">        balance being computed. It is used to provide context or information about the specific class</span>
<span class="sd">        balance being displayed in the user interface.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">balancer</span> <span class="o">=</span> <span class="n">ClassBalance</span><span class="p">(</span><span class="n">loader</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="n">class_col</span><span class="p">)</span>
        <span class="n">balance_df</span> <span class="o">=</span> <span class="n">balancer</span><span class="o">.</span><span class="n">compute_balance</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Class Balance for </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">class_col</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">balance_df</span><span class="p">)</span>

    <span class="c1"># --------------------------</span>
    <span class="c1"># Evaluation &amp; Visualization Helper (for single–column evaluation)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">pred_col</span><span class="p">,</span> <span class="n">ground_truth_col</span><span class="p">,</span> <span class="n">n_bootstraps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The `evaluate_model` function evaluates predictions by comparing them with ground truth,</span>
<span class="sd">        calculates metrics, generates a classification report, computes bootstrap confidence intervals,</span>
<span class="sd">        and plots a confusion matrix.</span>

<span class="sd">        Args:</span>
<span class="sd">          df: The `df` parameter in the `evaluate_model` function is a pandas DataFrame that contains</span>
<span class="sd">        the data for evaluation. It should include columns for predictions (`pred_col`) and ground truth</span>
<span class="sd">        (`ground_truth_col`) that will be used for evaluating the model&#39;s performance.</span>
<span class="sd">          pred_col: The `pred_col` parameter in the `evaluate_model` function refers to the column in</span>
<span class="sd">        the DataFrame `df` that contains the predicted values for the model. It is used to evaluate the</span>
<span class="sd">        predictions by comparing them with the ground truth values.</span>
<span class="sd">          ground_truth_col: The `ground_truth_col` parameter in the `evaluate_model` function refers to</span>
<span class="sd">        the column in the DataFrame `df` that contains the ground truth values for the predictions. This</span>
<span class="sd">        column is used to compare the predicted values with the actual ground truth values during the</span>
<span class="sd">        evaluation process.</span>
<span class="sd">          n_bootstraps: The `n_bootstraps` parameter in the `evaluate_model` function specifies the</span>
<span class="sd">        number of bootstrap samples to generate when computing bootstrap confidence intervals. It</span>
<span class="sd">        determines how many resamples of the data will be created to estimate the sampling distribution</span>
<span class="sd">        of a statistic. In this case, it is set to a default. Defaults to 1000</span>
<span class="sd">          alpha: The `alpha` parameter in the `evaluate_model` function represents the significance</span>
<span class="sd">        level used for computing Bootstrap Confidence Intervals. It is typically set to a value between</span>
<span class="sd">        0 and 1, such as 0.05, to determine the confidence level of the intervals. In this case, an `</span>

<span class="sd">        Returns:</span>
<span class="sd">          metrics_df, report_df, bs_df, cm_fig</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evaluate predictions by comparing with ground truth. Drops rows with NaN predictions.</span>
<span class="sd">        Returns:</span>
<span class="sd">            metrics_df, report_df, bs_df, cm_fig</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">pred_col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="n">ground_truth_col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">valid</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
            <span class="n">y_true</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">valid</span><span class="p">,</span> <span class="n">ground_truth_col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">valid</span><span class="p">,</span> <span class="n">pred_col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
            <span class="n">evaluator</span><span class="o">.</span><span class="n">calculate_metrics</span><span class="p">()</span>
            <span class="n">metrics_df</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">display_metrics</span><span class="p">()</span>
            <span class="n">report_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">evaluator</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="s2">&quot;Classification Report&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
            <span class="c1"># Compute Bootstrap Confidence Intervals.</span>
            <span class="n">bs_results</span> <span class="o">=</span> <span class="n">compute_bootstrap_confidence_intervals</span><span class="p">(</span>
                <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">n_bootstraps</span><span class="o">=</span><span class="n">n_bootstraps</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span>
            <span class="p">)</span>
            <span class="n">bs_display</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">bs_results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">values</span><span class="p">[</span><span class="s2">&quot;Value&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">bs_display</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;Metric&quot;</span><span class="p">:</span> <span class="n">metric</span><span class="p">,</span>
                            <span class="s2">&quot;Value&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">values</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;Bootstrap Mean&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">values</span><span class="p">[</span><span class="s1">&#39;Bootstrap Mean&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;95% CI&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">values</span><span class="p">[</span><span class="s1">&#39;95% CI&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">values</span><span class="p">[</span><span class="s1">&#39;95% CI&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                        <span class="p">}</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bs_display</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;Metric&quot;</span><span class="p">:</span> <span class="n">metric</span><span class="p">,</span>
                            <span class="s2">&quot;Value&quot;</span><span class="p">:</span> <span class="s2">&quot;Undefined&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;Bootstrap Mean&quot;</span><span class="p">:</span> <span class="s2">&quot;Undefined&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;95% CI&quot;</span><span class="p">:</span> <span class="s2">&quot;Undefined&quot;</span><span class="p">,</span>
                        <span class="p">}</span>
                    <span class="p">)</span>
            <span class="n">bs_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">bs_display</span><span class="p">)</span>
            <span class="n">cm_fig</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">metrics_df</span><span class="p">,</span> <span class="n">report_df</span><span class="p">,</span> <span class="n">bs_df</span><span class="p">,</span> <span class="n">cm_fig</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Selected evaluation columns not found in the dataframe.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">compare_methods</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">ground_truth_col</span><span class="p">,</span> <span class="n">selected_methods</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The `compare_methods` function compares selected prediction methods on a common data subset and</span>
<span class="sd">        returns evaluation results and confusion matrices for each method.</span>

<span class="sd">        Args:</span>
<span class="sd">          df: The `df` parameter in the `compare_methods` function is a pandas DataFrame containing the data</span>
<span class="sd">        for evaluation. It is used to compare selected prediction methods on a common data subset.</span>
<span class="sd">          ground_truth_col: The `ground_truth_col` parameter in the `compare_methods` function refers to the</span>
<span class="sd">        column in the DataFrame `df` that contains the ground truth values for the evaluation. This column</span>
<span class="sd">        should represent the true values that the selected prediction methods are compared against. It is</span>
<span class="sd">        typically the actual values that the models are</span>
<span class="sd">          selected_methods: The `selected_methods` parameter in the `compare_methods` function is a list of</span>
<span class="sd">        prediction methods that you want to compare. These methods should correspond to the columns in the</span>
<span class="sd">        DataFrame `df` that contain the predicted categories for each method. The function will evaluate</span>
<span class="sd">        these selected methods on a common subset of the</span>

<span class="sd">        Returns:</span>
<span class="sd">          The function `compare_methods` returns three values:</span>
<span class="sd">        1. `common_df`: Subset of the input dataframe `df` used for evaluation.</span>
<span class="sd">        2. `results`: A dictionary with each selected method&#39;s evaluation metrics.</span>
<span class="sd">        3. `confusion_matrices`: A dictionary with each selected method&#39;s confusion matrix figure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">method_columns</span> <span class="o">=</span> <span class="p">{</span><span class="n">method</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Predicted Category (</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">selected_methods</span><span class="p">}</span>
        <span class="n">valid_methods</span> <span class="o">=</span> <span class="p">{</span><span class="n">m</span><span class="p">:</span> <span class="n">col</span> <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">method_columns</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">}</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_methods</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No selected method prediction columns exist in the data.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{},</span> <span class="p">{}</span>

        <span class="n">common_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">valid_methods</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Common evaluation subset size: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">common_df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">confusion_matrices</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">method</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">valid_methods</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">y_true</span> <span class="o">=</span> <span class="n">common_df</span><span class="p">[</span><span class="n">ground_truth_col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">common_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
            <span class="n">evaluator</span><span class="o">.</span><span class="n">calculate_metrics</span><span class="p">()</span>
            <span class="n">results</span><span class="p">[</span><span class="n">method</span><span class="p">]</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">metrics</span>
            <span class="n">confusion_matrices</span><span class="p">[</span><span class="n">method</span><span class="p">]</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">common_df</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">confusion_matrices</span>

    <span class="c1"># --------------------------</span>
    <span class="c1"># Main Evaluation Workflow</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">handle_evaluation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The `handle_evaluation` function manages the evaluation workflow by uploading a CSV file, loading</span>
<span class="sd">        and previewing data, selecting evaluation methods, running evaluation, displaying results, and</span>
<span class="sd">        generating a downloadable DOCX report.</span>

<span class="sd">        Args:</span>
<span class="sd">          file: The `file` parameter in the `handle_evaluation` method is used to specify the CSV file that</span>
<span class="sd">        will be used for evaluation. If a file is not provided, the method will prompt the user to upload a</span>
<span class="sd">        CSV file. The method then proceeds to load and preview the data, select the ground truth</span>

<span class="sd">        Returns:</span>
<span class="sd">          The `handle_evaluation` method returns `None` if the `file` is not provided, indicating that the</span>
<span class="sd">        evaluation workflow cannot proceed without a CSV file.</span>

<span class="sd">        Handles the evaluation workflow by:</span>
<span class="sd">          - Uploading the CSV file (if not provided),</span>
<span class="sd">          - Loading and previewing the data,</span>
<span class="sd">          - Selecting the ground truth column and checking class balance,</span>
<span class="sd">          - Letting the user select one or more evaluation methods,</span>
<span class="sd">          - Running evaluation on demand,</span>
<span class="sd">          - Displaying the results, and</span>
<span class="sd">          - Generating a downloadable DOCX report.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># File upload (if not already provided)</span>
        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_file</span><span class="p">(</span>
            <span class="n">file</span><span class="p">,</span>
            <span class="n">upload_message</span><span class="o">=</span><span class="s2">&quot;Choose CSV file&quot;</span><span class="p">,</span>
            <span class="n">file_types</span><span class="o">=</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span>
            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;eval_file_uploader&quot;</span><span class="p">,</span>
            <span class="n">info_message</span><span class="o">=</span><span class="s2">&quot;Please upload a CSV file to proceed.&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">loader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preview_data</span><span class="p">(</span><span class="n">loader</span><span class="p">)</span>
        <span class="n">ground_truth_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_evaluation_column</span><span class="p">(</span><span class="n">loader</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_class_balance</span><span class="p">(</span><span class="n">loader</span><span class="p">,</span> <span class="n">ground_truth_col</span><span class="p">,</span> <span class="s2">&quot;Ground Truth&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s2">&quot;Evaluation&quot;</span><span class="p">)</span>
        <span class="n">selected_methods</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">multiselect</span><span class="p">(</span>
            <span class="s2">&quot;Select evaluation methods&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;Zero Shot&quot;</span><span class="p">,</span> <span class="s2">&quot;Few Shot&quot;</span><span class="p">,</span> <span class="s2">&quot;Many Shot&quot;</span><span class="p">],</span>
            <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Zero Shot&quot;</span><span class="p">,</span> <span class="s2">&quot;Few Shot&quot;</span><span class="p">,</span> <span class="s2">&quot;Many Shot&quot;</span><span class="p">],</span>
            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;eval_methods&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;Evaluate&quot;</span><span class="p">):</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="s2">&quot;Evaluating...&quot;</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">selected_methods</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Please select at least one method for evaluation.&quot;</span><span class="p">)</span>
                    <span class="k">return</span>

                <span class="n">common_df</span><span class="p">,</span> <span class="n">comparison_results</span><span class="p">,</span> <span class="n">confusion_matrices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_methods</span><span class="p">(</span>
                    <span class="n">loader</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="n">ground_truth_col</span><span class="p">,</span> <span class="n">selected_methods</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">comparison_results</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">method</span><span class="p">,</span> <span class="n">metrics</span> <span class="ow">in</span> <span class="n">comparison_results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>

                    <span class="n">docx_maker</span> <span class="o">=</span> <span class="n">StreamlitDocxCreator</span><span class="p">(</span><span class="n">comparison_results</span><span class="p">,</span> <span class="n">confusion_matrices</span><span class="p">)</span>
                    <span class="n">doc</span> <span class="o">=</span> <span class="n">docx_maker</span><span class="o">.</span><span class="n">create_docx_report</span><span class="p">()</span>
                    <span class="n">docx_content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_docx_report_download</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">download_button</span><span class="p">(</span>
                        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Download DOCX Report&quot;</span><span class="p">,</span>
                        <span class="n">data</span><span class="o">=</span><span class="n">docx_content</span><span class="p">,</span>
                        <span class="n">file_name</span><span class="o">=</span><span class="s2">&quot;evaluation_report.docx&quot;</span><span class="p">,</span>
                        <span class="n">mime</span><span class="o">=</span><span class="s2">&quot;application/vnd.openxmlformats-officedocument.wordprocessingml.document&quot;</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;No evaluation metrics available for the selected methods.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Click the Evaluate button to start evaluation.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="LabeLMaker.streamlit_interface.EvaluateHandler.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">ui_helper</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The above function is a constructor that initializes an object with a UI helper.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>ui_helper</code></b>
              –
              <div class="doc-md-description">
                <p>The <code>ui_helper</code> parameter in the <code>__init__</code> method is typically used to pass in an</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>object that provides utility functions or methods related to the user interface. This can
include functions for displaying information, handling user input, managing UI components, and
more. By passing in a `ui_helper</p>


            <details class="quote">
              <summary>Source code in <code>LabeLMaker/streamlit_interface.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ui_helper</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The above function is a constructor that initializes an object with a UI helper.</span>

<span class="sd">    Args:</span>
<span class="sd">      ui_helper: The `ui_helper` parameter in the `__init__` method is typically used to pass in an</span>
<span class="sd">    object that provides utility functions or methods related to the user interface. This can</span>
<span class="sd">    include functions for displaying information, handling user input, managing UI components, and</span>
<span class="sd">    more. By passing in a `ui_helper</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ui_helper</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="LabeLMaker.streamlit_interface.EvaluateHandler.check_class_balance" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_class_balance</span><span class="p">(</span><span class="n">loader</span><span class="p">,</span> <span class="n">class_col</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The function <code>check_class_balance</code> computes the class balance for a specified column in a
DataFrame and displays the results using a UI subheader and table.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>loader</code></b>
              –
              <div class="doc-md-description">
                <p>The <code>loader</code> parameter is likely an object that helps load or manage data, such as a</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>data loader object used in machine learning frameworks like PyTorch or TensorFlow. It is being
used to access the data frame (<code>loader.df</code>) containing the dataset.
  class_col: The <code>class_col</code> parameter in the <code>check_class_balance</code> function is used to specify
the column in the dataset that contains the class labels or categories for which you want to
check the balance. This column will be used by the <code>ClassBalance</code> to compute the balance of the
classes in the dataset
  label: The <code>label</code> parameter is a string that represents the label or title of the class
balance being computed. It is used to provide context or information about the specific class
balance being displayed in the user interface.</p>


            <details class="quote">
              <summary>Source code in <code>LabeLMaker/streamlit_interface.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_class_balance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loader</span><span class="p">,</span> <span class="n">class_col</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The function `check_class_balance` computes the class balance for a specified column in a</span>
<span class="sd">    DataFrame and displays the results using a UI subheader and table.</span>

<span class="sd">    Args:</span>
<span class="sd">      loader: The `loader` parameter is likely an object that helps load or manage data, such as a</span>
<span class="sd">    data loader object used in machine learning frameworks like PyTorch or TensorFlow. It is being</span>
<span class="sd">    used to access the data frame (`loader.df`) containing the dataset.</span>
<span class="sd">      class_col: The `class_col` parameter in the `check_class_balance` function is used to specify</span>
<span class="sd">    the column in the dataset that contains the class labels or categories for which you want to</span>
<span class="sd">    check the balance. This column will be used by the `ClassBalance` to compute the balance of the</span>
<span class="sd">    classes in the dataset</span>
<span class="sd">      label: The `label` parameter is a string that represents the label or title of the class</span>
<span class="sd">    balance being computed. It is used to provide context or information about the specific class</span>
<span class="sd">    balance being displayed in the user interface.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">balancer</span> <span class="o">=</span> <span class="n">ClassBalance</span><span class="p">(</span><span class="n">loader</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="n">class_col</span><span class="p">)</span>
    <span class="n">balance_df</span> <span class="o">=</span> <span class="n">balancer</span><span class="o">.</span><span class="n">compute_balance</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Class Balance for </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">class_col</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">balance_df</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="LabeLMaker.streamlit_interface.EvaluateHandler.compare_methods" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compare_methods</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">ground_truth_col</span><span class="p">,</span> <span class="n">selected_methods</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The <code>compare_methods</code> function compares selected prediction methods on a common data subset and
returns evaluation results and confusion matrices for each method.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>df</code></b>
              –
              <div class="doc-md-description">
                <p>The <code>df</code> parameter in the <code>compare_methods</code> function is a pandas DataFrame containing the data</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>for evaluation. It is used to compare selected prediction methods on a common data subset.
  ground_truth_col: The <code>ground_truth_col</code> parameter in the <code>compare_methods</code> function refers to the
column in the DataFrame <code>df</code> that contains the ground truth values for the evaluation. This column
should represent the true values that the selected prediction methods are compared against. It is
typically the actual values that the models are
  selected_methods: The <code>selected_methods</code> parameter in the <code>compare_methods</code> function is a list of
prediction methods that you want to compare. These methods should correspond to the columns in the
DataFrame <code>df</code> that contain the predicted categories for each method. The function will evaluate
these selected methods on a common subset of the</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>The function <code>compare_methods</code> returns three values:</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <ol>
<li><code>common_df</code>: Subset of the input dataframe <code>df</code> used for evaluation.</li>
<li><code>results</code>: A dictionary with each selected method's evaluation metrics.</li>
<li><code>confusion_matrices</code>: A dictionary with each selected method's confusion matrix figure.</li>
</ol>


            <details class="quote">
              <summary>Source code in <code>LabeLMaker/streamlit_interface.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compare_methods</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">ground_truth_col</span><span class="p">,</span> <span class="n">selected_methods</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The `compare_methods` function compares selected prediction methods on a common data subset and</span>
<span class="sd">    returns evaluation results and confusion matrices for each method.</span>

<span class="sd">    Args:</span>
<span class="sd">      df: The `df` parameter in the `compare_methods` function is a pandas DataFrame containing the data</span>
<span class="sd">    for evaluation. It is used to compare selected prediction methods on a common data subset.</span>
<span class="sd">      ground_truth_col: The `ground_truth_col` parameter in the `compare_methods` function refers to the</span>
<span class="sd">    column in the DataFrame `df` that contains the ground truth values for the evaluation. This column</span>
<span class="sd">    should represent the true values that the selected prediction methods are compared against. It is</span>
<span class="sd">    typically the actual values that the models are</span>
<span class="sd">      selected_methods: The `selected_methods` parameter in the `compare_methods` function is a list of</span>
<span class="sd">    prediction methods that you want to compare. These methods should correspond to the columns in the</span>
<span class="sd">    DataFrame `df` that contain the predicted categories for each method. The function will evaluate</span>
<span class="sd">    these selected methods on a common subset of the</span>

<span class="sd">    Returns:</span>
<span class="sd">      The function `compare_methods` returns three values:</span>
<span class="sd">    1. `common_df`: Subset of the input dataframe `df` used for evaluation.</span>
<span class="sd">    2. `results`: A dictionary with each selected method&#39;s evaluation metrics.</span>
<span class="sd">    3. `confusion_matrices`: A dictionary with each selected method&#39;s confusion matrix figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">method_columns</span> <span class="o">=</span> <span class="p">{</span><span class="n">method</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Predicted Category (</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">selected_methods</span><span class="p">}</span>
    <span class="n">valid_methods</span> <span class="o">=</span> <span class="p">{</span><span class="n">m</span><span class="p">:</span> <span class="n">col</span> <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">method_columns</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">}</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_methods</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No selected method prediction columns exist in the data.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{},</span> <span class="p">{}</span>

    <span class="n">common_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">valid_methods</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Common evaluation subset size: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">common_df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">confusion_matrices</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">method</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">valid_methods</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">y_true</span> <span class="o">=</span> <span class="n">common_df</span><span class="p">[</span><span class="n">ground_truth_col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">common_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">evaluator</span><span class="o">.</span><span class="n">calculate_metrics</span><span class="p">()</span>
        <span class="n">results</span><span class="p">[</span><span class="n">method</span><span class="p">]</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">metrics</span>
        <span class="n">confusion_matrices</span><span class="p">[</span><span class="n">method</span><span class="p">]</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">common_df</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">confusion_matrices</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="LabeLMaker.streamlit_interface.EvaluateHandler.evaluate_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">evaluate_model</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pred_col</span><span class="p">,</span> <span class="n">ground_truth_col</span><span class="p">,</span> <span class="n">n_bootstraps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The <code>evaluate_model</code> function evaluates predictions by comparing them with ground truth,
calculates metrics, generates a classification report, computes bootstrap confidence intervals,
and plots a confusion matrix.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>df</code></b>
              –
              <div class="doc-md-description">
                <p>The <code>df</code> parameter in the <code>evaluate_model</code> function is a pandas DataFrame that contains</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>the data for evaluation. It should include columns for predictions (<code>pred_col</code>) and ground truth
(<code>ground_truth_col</code>) that will be used for evaluating the model's performance.
  pred_col: The <code>pred_col</code> parameter in the <code>evaluate_model</code> function refers to the column in
the DataFrame <code>df</code> that contains the predicted values for the model. It is used to evaluate the
predictions by comparing them with the ground truth values.
  ground_truth_col: The <code>ground_truth_col</code> parameter in the <code>evaluate_model</code> function refers to
the column in the DataFrame <code>df</code> that contains the ground truth values for the predictions. This
column is used to compare the predicted values with the actual ground truth values during the
evaluation process.
  n_bootstraps: The <code>n_bootstraps</code> parameter in the <code>evaluate_model</code> function specifies the
number of bootstrap samples to generate when computing bootstrap confidence intervals. It
determines how many resamples of the data will be created to estimate the sampling distribution
of a statistic. In this case, it is set to a default. Defaults to 1000
  alpha: The <code>alpha</code> parameter in the <code>evaluate_model</code> function represents the significance
level used for computing Bootstrap Confidence Intervals. It is typically set to a value between
0 and 1, such as 0.05, to determine the confidence level of the intervals. In this case, an `</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>metrics_df, report_df, bs_df, cm_fig</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>LabeLMaker/streamlit_interface.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">evaluate_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">pred_col</span><span class="p">,</span> <span class="n">ground_truth_col</span><span class="p">,</span> <span class="n">n_bootstraps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The `evaluate_model` function evaluates predictions by comparing them with ground truth,</span>
<span class="sd">    calculates metrics, generates a classification report, computes bootstrap confidence intervals,</span>
<span class="sd">    and plots a confusion matrix.</span>

<span class="sd">    Args:</span>
<span class="sd">      df: The `df` parameter in the `evaluate_model` function is a pandas DataFrame that contains</span>
<span class="sd">    the data for evaluation. It should include columns for predictions (`pred_col`) and ground truth</span>
<span class="sd">    (`ground_truth_col`) that will be used for evaluating the model&#39;s performance.</span>
<span class="sd">      pred_col: The `pred_col` parameter in the `evaluate_model` function refers to the column in</span>
<span class="sd">    the DataFrame `df` that contains the predicted values for the model. It is used to evaluate the</span>
<span class="sd">    predictions by comparing them with the ground truth values.</span>
<span class="sd">      ground_truth_col: The `ground_truth_col` parameter in the `evaluate_model` function refers to</span>
<span class="sd">    the column in the DataFrame `df` that contains the ground truth values for the predictions. This</span>
<span class="sd">    column is used to compare the predicted values with the actual ground truth values during the</span>
<span class="sd">    evaluation process.</span>
<span class="sd">      n_bootstraps: The `n_bootstraps` parameter in the `evaluate_model` function specifies the</span>
<span class="sd">    number of bootstrap samples to generate when computing bootstrap confidence intervals. It</span>
<span class="sd">    determines how many resamples of the data will be created to estimate the sampling distribution</span>
<span class="sd">    of a statistic. In this case, it is set to a default. Defaults to 1000</span>
<span class="sd">      alpha: The `alpha` parameter in the `evaluate_model` function represents the significance</span>
<span class="sd">    level used for computing Bootstrap Confidence Intervals. It is typically set to a value between</span>
<span class="sd">    0 and 1, such as 0.05, to determine the confidence level of the intervals. In this case, an `</span>

<span class="sd">    Returns:</span>
<span class="sd">      metrics_df, report_df, bs_df, cm_fig</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate predictions by comparing with ground truth. Drops rows with NaN predictions.</span>
<span class="sd">    Returns:</span>
<span class="sd">        metrics_df, report_df, bs_df, cm_fig</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">pred_col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="n">ground_truth_col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">valid</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
        <span class="n">y_true</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">valid</span><span class="p">,</span> <span class="n">ground_truth_col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">valid</span><span class="p">,</span> <span class="n">pred_col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">evaluator</span><span class="o">.</span><span class="n">calculate_metrics</span><span class="p">()</span>
        <span class="n">metrics_df</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">display_metrics</span><span class="p">()</span>
        <span class="n">report_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">evaluator</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="s2">&quot;Classification Report&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="c1"># Compute Bootstrap Confidence Intervals.</span>
        <span class="n">bs_results</span> <span class="o">=</span> <span class="n">compute_bootstrap_confidence_intervals</span><span class="p">(</span>
            <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">n_bootstraps</span><span class="o">=</span><span class="n">n_bootstraps</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span>
        <span class="p">)</span>
        <span class="n">bs_display</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">bs_results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">values</span><span class="p">[</span><span class="s2">&quot;Value&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">bs_display</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;Metric&quot;</span><span class="p">:</span> <span class="n">metric</span><span class="p">,</span>
                        <span class="s2">&quot;Value&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">values</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Bootstrap Mean&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">values</span><span class="p">[</span><span class="s1">&#39;Bootstrap Mean&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;95% CI&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">values</span><span class="p">[</span><span class="s1">&#39;95% CI&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">values</span><span class="p">[</span><span class="s1">&#39;95% CI&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                    <span class="p">}</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">bs_display</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;Metric&quot;</span><span class="p">:</span> <span class="n">metric</span><span class="p">,</span>
                        <span class="s2">&quot;Value&quot;</span><span class="p">:</span> <span class="s2">&quot;Undefined&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Bootstrap Mean&quot;</span><span class="p">:</span> <span class="s2">&quot;Undefined&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;95% CI&quot;</span><span class="p">:</span> <span class="s2">&quot;Undefined&quot;</span><span class="p">,</span>
                    <span class="p">}</span>
                <span class="p">)</span>
        <span class="n">bs_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">bs_display</span><span class="p">)</span>
        <span class="n">cm_fig</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">metrics_df</span><span class="p">,</span> <span class="n">report_df</span><span class="p">,</span> <span class="n">bs_df</span><span class="p">,</span> <span class="n">cm_fig</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Selected evaluation columns not found in the dataframe.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="LabeLMaker.streamlit_interface.EvaluateHandler.handle_evaluation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">handle_evaluation</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The <code>handle_evaluation</code> function manages the evaluation workflow by uploading a CSV file, loading
and previewing data, selecting evaluation methods, running evaluation, displaying results, and
generating a downloadable DOCX report.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>file</code></b>
              –
              <div class="doc-md-description">
                <p>The <code>file</code> parameter in the <code>handle_evaluation</code> method is used to specify the CSV file that</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>will be used for evaluation. If a file is not provided, the method will prompt the user to upload a
CSV file. The method then proceeds to load and preview the data, select the ground truth</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>The <code>handle_evaluation</code> method returns <code>None</code> if the <code>file</code> is not provided, indicating that the</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>evaluation workflow cannot proceed without a CSV file.</p>


<details class="handles-the-evaluation-workflow-by" open>
  <summary>Handles the evaluation workflow by</summary>
  <ul>
<li>Uploading the CSV file (if not provided),</li>
<li>Loading and previewing the data,</li>
<li>Selecting the ground truth column and checking class balance,</li>
<li>Letting the user select one or more evaluation methods,</li>
<li>Running evaluation on demand,</li>
<li>Displaying the results, and</li>
<li>Generating a downloadable DOCX report.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>LabeLMaker/streamlit_interface.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">handle_evaluation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The `handle_evaluation` function manages the evaluation workflow by uploading a CSV file, loading</span>
<span class="sd">    and previewing data, selecting evaluation methods, running evaluation, displaying results, and</span>
<span class="sd">    generating a downloadable DOCX report.</span>

<span class="sd">    Args:</span>
<span class="sd">      file: The `file` parameter in the `handle_evaluation` method is used to specify the CSV file that</span>
<span class="sd">    will be used for evaluation. If a file is not provided, the method will prompt the user to upload a</span>
<span class="sd">    CSV file. The method then proceeds to load and preview the data, select the ground truth</span>

<span class="sd">    Returns:</span>
<span class="sd">      The `handle_evaluation` method returns `None` if the `file` is not provided, indicating that the</span>
<span class="sd">    evaluation workflow cannot proceed without a CSV file.</span>

<span class="sd">    Handles the evaluation workflow by:</span>
<span class="sd">      - Uploading the CSV file (if not provided),</span>
<span class="sd">      - Loading and previewing the data,</span>
<span class="sd">      - Selecting the ground truth column and checking class balance,</span>
<span class="sd">      - Letting the user select one or more evaluation methods,</span>
<span class="sd">      - Running evaluation on demand,</span>
<span class="sd">      - Displaying the results, and</span>
<span class="sd">      - Generating a downloadable DOCX report.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># File upload (if not already provided)</span>
    <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_file</span><span class="p">(</span>
        <span class="n">file</span><span class="p">,</span>
        <span class="n">upload_message</span><span class="o">=</span><span class="s2">&quot;Choose CSV file&quot;</span><span class="p">,</span>
        <span class="n">file_types</span><span class="o">=</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span>
        <span class="n">key</span><span class="o">=</span><span class="s2">&quot;eval_file_uploader&quot;</span><span class="p">,</span>
        <span class="n">info_message</span><span class="o">=</span><span class="s2">&quot;Please upload a CSV file to proceed.&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">loader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">preview_data</span><span class="p">(</span><span class="n">loader</span><span class="p">)</span>
    <span class="n">ground_truth_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_evaluation_column</span><span class="p">(</span><span class="n">loader</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">check_class_balance</span><span class="p">(</span><span class="n">loader</span><span class="p">,</span> <span class="n">ground_truth_col</span><span class="p">,</span> <span class="s2">&quot;Ground Truth&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s2">&quot;Evaluation&quot;</span><span class="p">)</span>
    <span class="n">selected_methods</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">multiselect</span><span class="p">(</span>
        <span class="s2">&quot;Select evaluation methods&quot;</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">&quot;Zero Shot&quot;</span><span class="p">,</span> <span class="s2">&quot;Few Shot&quot;</span><span class="p">,</span> <span class="s2">&quot;Many Shot&quot;</span><span class="p">],</span>
        <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Zero Shot&quot;</span><span class="p">,</span> <span class="s2">&quot;Few Shot&quot;</span><span class="p">,</span> <span class="s2">&quot;Many Shot&quot;</span><span class="p">],</span>
        <span class="n">key</span><span class="o">=</span><span class="s2">&quot;eval_methods&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;Evaluate&quot;</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="s2">&quot;Evaluating...&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">selected_methods</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Please select at least one method for evaluation.&quot;</span><span class="p">)</span>
                <span class="k">return</span>

            <span class="n">common_df</span><span class="p">,</span> <span class="n">comparison_results</span><span class="p">,</span> <span class="n">confusion_matrices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_methods</span><span class="p">(</span>
                <span class="n">loader</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="n">ground_truth_col</span><span class="p">,</span> <span class="n">selected_methods</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">comparison_results</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">method</span><span class="p">,</span> <span class="n">metrics</span> <span class="ow">in</span> <span class="n">comparison_results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>

                <span class="n">docx_maker</span> <span class="o">=</span> <span class="n">StreamlitDocxCreator</span><span class="p">(</span><span class="n">comparison_results</span><span class="p">,</span> <span class="n">confusion_matrices</span><span class="p">)</span>
                <span class="n">doc</span> <span class="o">=</span> <span class="n">docx_maker</span><span class="o">.</span><span class="n">create_docx_report</span><span class="p">()</span>
                <span class="n">docx_content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_docx_report_download</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">download_button</span><span class="p">(</span>
                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Download DOCX Report&quot;</span><span class="p">,</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">docx_content</span><span class="p">,</span>
                    <span class="n">file_name</span><span class="o">=</span><span class="s2">&quot;evaluation_report.docx&quot;</span><span class="p">,</span>
                    <span class="n">mime</span><span class="o">=</span><span class="s2">&quot;application/vnd.openxmlformats-officedocument.wordprocessingml.document&quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;No evaluation metrics available for the selected methods.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Click the Evaluate button to start evaluation.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="LabeLMaker.streamlit_interface.EvaluateHandler.load_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_data</span><span class="p">(</span><span class="n">file</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The function <code>load_data</code> creates a <code>DataLoader</code> object with the specified file and returns it.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>file</code></b>
              –
              <div class="doc-md-description">
                <p>The <code>file</code> parameter in the <code>load_data</code> method is the file path or name that you want to</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>load data from. This parameter is used to specify the location of the file that the <code>DataLoader</code>
will load data from.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>An instance of the DataLoader class with the specified file.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>LabeLMaker/streamlit_interface.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The function `load_data` creates a `DataLoader` object with the specified file and returns it.</span>

<span class="sd">    Args:</span>
<span class="sd">      file: The `file` parameter in the `load_data` method is the file path or name that you want to</span>
<span class="sd">    load data from. This parameter is used to specify the location of the file that the `DataLoader`</span>
<span class="sd">    will load data from.</span>

<span class="sd">    Returns:</span>
<span class="sd">      An instance of the DataLoader class with the specified file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">loader</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="LabeLMaker.streamlit_interface.EvaluateHandler.preview_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">preview_data</span><span class="p">(</span><span class="n">loader</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The function <code>preview_data</code> displays a preview of the CSV data loaded by the <code>loader</code> object,
including the first few rows and the total number of rows in the dataframe.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>loader</code></b>
              –
              <div class="doc-md-description">
                <p>The <code>loader</code> parameter in the <code>preview_data</code> method is likely an object that contains</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>a DataFrame (<code>df</code>) attribute. This DataFrame is used to display a preview of the data in the CSV
file being loaded. The method displays the first few rows of the DataFrame and the total number
of rows in</p>


            <details class="quote">
              <summary>Source code in <code>LabeLMaker/streamlit_interface.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">preview_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loader</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The function `preview_data` displays a preview of the CSV data loaded by the `loader` object,</span>
<span class="sd">    including the first few rows and the total number of rows in the dataframe.</span>

<span class="sd">    Args:</span>
<span class="sd">      loader: The `loader` parameter in the `preview_data` method is likely an object that contains</span>
<span class="sd">    a DataFrame (`df`) attribute. This DataFrame is used to display a preview of the data in the CSV</span>
<span class="sd">    file being loaded. The method displays the first few rows of the DataFrame and the total number</span>
<span class="sd">    of rows in</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="s2">&quot;CSV Preview:&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">loader</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total rows in dataframe: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">loader</span><span class="o">.</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="LabeLMaker.streamlit_interface.EvaluateHandler.select_evaluation_column" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">select_evaluation_column</span><span class="p">(</span><span class="n">loader</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The function <code>select_evaluation_column</code> prompts the user to select a column from a DataFrame for
use as the ground truth column.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>loader</code></b>
              –
              <div class="doc-md-description">
                <p>The <code>loader</code> parameter in the <code>select_evaluation_column</code> method seems to be an object</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>that has a property <code>df</code> which is a DataFrame. The method allows the user to select a column
from the DataFrame <code>loader.df</code> as the ground truth column. The user interface (UI) component
used</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>the column selected as the ground truth column from the DataFrame loaded by the loader.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>LabeLMaker/streamlit_interface.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">select_evaluation_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loader</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The function `select_evaluation_column` prompts the user to select a column from a DataFrame for</span>
<span class="sd">    use as the ground truth column.</span>

<span class="sd">    Args:</span>
<span class="sd">      loader: The `loader` parameter in the `select_evaluation_column` method seems to be an object</span>
<span class="sd">    that has a property `df` which is a DataFrame. The method allows the user to select a column</span>
<span class="sd">    from the DataFrame `loader.df` as the ground truth column. The user interface (UI) component</span>
<span class="sd">    used</span>

<span class="sd">    Returns:</span>
<span class="sd">      the column selected as the ground truth column from the DataFrame loaded by the loader.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ground_truth_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span>
        <span class="s2">&quot;Select Ground Truth Column&quot;</span><span class="p">,</span> <span class="n">loader</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;eval_gt_column&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">ground_truth_col</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="workflow.html" class="btn btn-neutral float-left" title="Main"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="Categorize/categorizer.html" class="btn btn-neutral float-right" title="Categorizer">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/uabperiopai" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="workflow.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="Categorize/categorizer.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
